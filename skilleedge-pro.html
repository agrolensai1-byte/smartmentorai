<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartMentorAI Pro - Master Tomorrow's Tech, Today</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Advanced Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#0ea5a4',
                        'primary-light': '#0ea5a4',
                        'secondary': '#06b6d4',
                        'accent': '#8b5cf6',
                        'dark': '#0a0e1a',
                        'darker': '#080b14',
                        'card': '#141820',
                    },
                    animation: {
                        'shimmer': 'shimmer 2s infinite',
                        'pulse-glow': 'pulse-glow 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 3s ease-in-out infinite',
                        'slide-down': 'slide-down 0.3s ease',
                        'fade-in': 'fade-in 0.4s ease',
                        'gradient-flow': 'gradient-flow 3s ease infinite',
                    },
                    keyframes: {
                        'shimmer': {
                            '0%': { transform: 'translateX(-100%)' },
                            '100%': { transform: 'translateX(100%)' },
                        },
                        'pulse-glow': {
                            '0%, 100%': { opacity: '1', boxShadow: '0 0 20px rgba(14, 165, 164, 0.5)' },
                            '50%': { opacity: '0.8', boxShadow: '0 0 40px rgba(14, 165, 164, 0.3)' },
                        },
                        'float': {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        'slide-down': {
                            'from': { opacity: '0', transform: 'translateY(-20px) scale(0.95)' },
                            'to': { opacity: '1', transform: 'translateY(0) scale(1)' },
                        },
                        'fade-in': {
                            'from': { opacity: '0', transform: 'scale(0.98) translateY(10px)' },
                            'to': { opacity: '1', transform: 'scale(1) translateY(0)' },
                        },
                        'gradient-flow': {
                            '0%': { backgroundPosition: '0% 50%' },
                            '50%': { backgroundPosition: '100% 50%' },
                            '100%': { backgroundPosition: '0% 50%' },
                        },
                    },
                    backgroundImage: {
                        'gradient-primary': 'linear-gradient(135deg, #0ea5a4 0%, #06b6d4 100%)',
                        'gradient-accent': 'linear-gradient(135deg, #0ea5a4 0%, #06b6d4 50%, #8b5cf6 100%)',
                    },
                    backdropBlur: {
                        xs: '2px',
                    },
                    boxShadow: {
                        'glow': '0 0 20px rgba(14, 165, 164, 0.5)',
                        'glow-lg': '0 0 40px rgba(14, 165, 164, 0.3)',
                        'card-hover': '0 16px 64px rgba(14, 165, 164, 0.15)',
                    },
                },
            },
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #0ea5a4;
            --secondary: #06b6d4;
            --accent: #8b5cf6;
            --dark: #0a0e1a;
            --darker: #080b14;
            --card: #141820;
            --card-light: #1a202c;
            --text: #f0f4f9;
            --muted: #a0aec0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        body { 
            background: linear-gradient(135deg, var(--darker) 0%, var(--dark) 50%, #1a1a2e 100%);
            color: var(--text);
            font-family: 'Outfit', 'Plus Jakarta Sans', sans-serif;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(14, 165, 164, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
        
        /* Sidebar Layout */
        .sidebar-layout { display: flex; min-height: 100vh; position: relative; z-index: 1; }
        .sidebar { 
            width: 270px; 
            background: linear-gradient(180deg, var(--card) 0%, var(--darker) 100%);
            border-right: 1px solid rgba(14, 165, 164, 0.1);
            padding: 30px 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            z-index: 100;
        }
        
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }
        
        .sidebar::-webkit-scrollbar-track {
            background: rgba(14, 165, 164, 0.05);
        }
        
        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(14, 165, 164, 0.3);
            border-radius: 3px;
        }
        
        .main-content {
            margin-left: 270px;
            flex: 1;
            padding: 50px 60px;
            background: linear-gradient(to bottom, rgba(10, 14, 26, 0.5), rgba(26, 26, 46, 0.3));
        }
        
        /* Advanced Button Styles */
        .btn-primary { 
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 14px 32px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.95rem;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 10px 30px rgba(14, 165, 164, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 45px rgba(14, 165, 164, 0.5);
            letter-spacing: 0.5px;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-secondary { 
            background: rgba(14, 165, 164, 0.08);
            color: var(--primary);
            border: 2px solid rgba(14, 165, 164, 0.3);
            padding: 12px 28px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .btn-secondary:hover { 
            background: rgba(14, 165, 164, 0.15);
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(14, 165, 164, 0.2);
        }
        
        .card { 
            background: linear-gradient(135deg, var(--card) 0%, var(--card-light) 100%);
            border-radius: 16px;
            padding: 28px;
            border: 1px solid rgba(14, 165, 164, 0.1);
            backdrop-filter: blur(20px);
            box-shadow: 0 12px 48px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: -100%;
            right: -100%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(14, 165, 164, 0.1), transparent);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            border-color: rgba(14, 165, 164, 0.3);
            box-shadow: 0 16px 64px rgba(14, 165, 164, 0.15);
            transform: translateY(-4px);
        }
        
        .card:hover::before {
            top: -50%;
            right: -50%;
        }
        
        .input-field {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, 0.03);
            border: 1.5px solid rgba(14, 165, 164, 0.15);
            border-radius: 12px;
            color: var(--text);
            font-size: 0.95rem;
            font-family: inherit;
            transition: all 0.3s ease;
            margin-bottom: 14px;
        }
        
        .input-field::placeholder {
            color: rgba(160, 174, 192, 0.5);
        }
        
        .input-field:focus { 
            outline: none;
            border-color: var(--primary);
            background: rgba(14, 165, 164, 0.08);
            box-shadow: 0 0 20px rgba(14, 165, 164, 0.25);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 50%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        
        .progress-bar {
            background: rgba(255, 255, 255, 0.05);
            height: 10px;
            border-radius: 20px;
            overflow: hidden;
            margin: 16px 0;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            height: 100%;
            border-radius: 20px;
            transition: width 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            box-shadow: 0 0 15px rgba(14, 165, 164, 0.5);
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
            border-radius: 20px;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .section { display: none; }
        .section.active { display: block; animation: fadeInScale 0.4s ease; }
        
        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.98) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(12px);
            animation: fadeIn 0.3s ease;
        }
        
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: linear-gradient(135deg, var(--card) 0%, var(--card-light) 100%);
            padding: 45px;
            border-radius: 20px;
            max-width: 650px;
            width: 90%;
            border: 1px solid rgba(14, 165, 164, 0.2);
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.2), rgba(6, 182, 212, 0.1));
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin: 4px 4px 4px 0;
            border: 1px solid rgba(14, 165, 164, 0.3);
            transition: all 0.3s ease;
        }
        
        .badge:hover {
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.3), rgba(6, 182, 212, 0.2));
            transform: translateY(-2px);
        }
        
        .alert {
            padding: 18px 24px;
            border-radius: 12px;
            margin-bottom: 16px;
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 999;
            max-width: 420px;
            font-weight: 600;
            border-left: 4px solid;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: slideDown 0.3s ease;
        }
        
        .alert.show { display: block; }
        
        .alert-success {
            background: rgba(16, 185, 129, 0.12);
            border-left-color: var(--success);
            color: var(--success);
        }
        
        .alert-error {
            background: rgba(239, 68, 68, 0.12);
            border-left-color: var(--error);
            color: var(--error);
        }
        
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .sidebar-nav {
            list-style: none;
        }
        
        .sidebar-nav li {
            margin: 8px 0;
        }
        
        .sidebar-nav a {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 14px 16px;
            color: var(--muted);
            text-decoration: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
        }
        
        .sidebar-nav a::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            border-radius: 0 4px 4px 0;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .sidebar-nav a:hover {
            color: var(--primary);
            background: rgba(14, 165, 164, 0.12);
            padding-left: 20px;
        }
        
        .sidebar-nav a.active {
            color: var(--primary);
            background: rgba(14, 165, 164, 0.15);
        }
        
        .sidebar-nav a.active::before {
            opacity: 1;
        }
        
        .stat-card {
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.15), rgba(6, 182, 212, 0.08));
            padding: 28px;
            border-radius: 16px;
            border: 1px solid rgba(14, 165, 164, 0.2);
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(14, 165, 164, 0.1), transparent);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-8px);
            border-color: rgba(14, 165, 164, 0.4);
            box-shadow: 0 12px 40px rgba(14, 165, 164, 0.2);
        }
        
        .stat-card:hover::after {
            top: 0;
            right: 0;
        }
        
        .stat-value {
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 2;
        }
        
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 28px;
        }
        
        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
        }
        
        .skill-slider {
            margin: 28px 0;
            padding: 20px;
            background: rgba(14, 165, 164, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(14, 165, 164, 0.1);
            transition: all 0.3s ease;
        }
        
        .skill-slider:hover {
            background: rgba(14, 165, 164, 0.08);
            border-color: rgba(14, 165, 164, 0.2);
        }
        
        .skill-slider label {
            display: block;
            margin-bottom: 12px;
            font-weight: 700;
            font-size: 1rem;
            color: var(--text);
        }
        
        .skill-slider input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 8px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            cursor: pointer;
        }
        
        .skill-slider input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(14, 165, 164, 0.4);
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .skill-slider input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(14, 165, 164, 0.6);
        }
        
        .skill-slider input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 4px 12px rgba(14, 165, 164, 0.4);
            transition: all 0.3s ease;
        }
        
        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            padding: 20px 0;
        }
        
        .step {
            text-align: center;
            flex: 1;
            position: relative;
        }
        
        .step::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 50%;
            width: calc(100% - 40px);
            height: 2px;
            background: rgba(14, 165, 164, 0.1);
            z-index: 0;
        }
        
        .step:last-child::after {
            display: none;
        }
        
        .step-number {
            display: inline-block;
            width: 50px;
            height: 50px;
            background: rgba(14, 165, 164, 0.15);
            border-radius: 50%;
            line-height: 50px;
            color: var(--muted);
            margin-bottom: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            border: 2px solid rgba(14, 165, 164, 0.2);
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }
        
        .step.active .step-number {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: var(--primary);
            box-shadow: 0 8px 20px rgba(14, 165, 164, 0.4);
            transform: scale(1.1);
        }
        
        .step.completed .step-number {
            background: linear-gradient(135deg, var(--success), #059669);
            color: white;
            border-color: var(--success);
        }
        
        .interest-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(170px, 1fr));
            gap: 18px;
            margin: 28px 0;
        }
        
        .interest-card {
            padding: 28px 20px;
            border: 2px solid rgba(14, 165, 164, 0.2);
            border-radius: 14px;
            text-align: center;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.34, 1.56, 0.64, 1);
            background: rgba(14, 165, 164, 0.02);
            position: relative;
            overflow: hidden;
        }
        
        .interest-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(14, 165, 164, 0.1), transparent);
            transition: left 0.5s ease;
        }
        
        .interest-card:hover {
            border-color: var(--primary);
            background: rgba(14, 165, 164, 0.08);
            transform: translateY(-6px);
            box-shadow: 0 12px 30px rgba(14, 165, 164, 0.2);
        }
        
        .interest-card:hover::before {
            left: 100%;
        }
        
        .interest-card.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.15), rgba(6, 182, 212, 0.08));
            box-shadow: 0 12px 30px rgba(14, 165, 164, 0.25);
            transform: scale(1.05);
        }
        
        .interest-icon {
            font-size: 2.8rem;
            margin-bottom: 14px;
            transition: all 0.3s ease;
            display: block;
        }
        
        .interest-card:hover .interest-icon {
            transform: scale(1.15) rotate(5deg);
        }
        
        .course-card {
            background: linear-gradient(135deg, var(--card) 0%, var(--card-light) 100%);
            border-radius: 16px;
            padding: 28px;
            border: 1px solid rgba(14, 165, 164, 0.15);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .course-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, rgba(14, 165, 164, 0.1), transparent);
            transition: all 0.4s ease;
        }
        
        .course-card:hover {
            transform: translateY(-12px);
            border-color: var(--primary);
            box-shadow: 0 20px 50px rgba(14, 165, 164, 0.25);
        }
        
        .course-card:hover::after {
            top: -20%;
            right: -20%;
        }
        
        .module-item {
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.05), rgba(6, 182, 212, 0.02));
            padding: 18px 20px;
            border-radius: 12px;
            margin-bottom: 14px;
            border-left: 4px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.35s ease;
            position: relative;
            overflow: hidden;
        }
        
        .module-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 3px;
            height: 100%;
            background: linear-gradient(180deg, var(--primary), var(--secondary));
            transition: width 0.3s ease;
        }
        
        .module-item:hover {
            background: rgba(14, 165, 164, 0.12);
            transform: translateX(4px);
            box-shadow: 0 8px 20px rgba(14, 165, 164, 0.15);
        }
        
        .module-item.completed {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.08), rgba(16, 185, 129, 0.02));
            border-left-color: var(--success);
        }
        
        .animation-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(14, 165, 164, 0.2);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 24px auto;
            box-shadow: 0 0 20px rgba(14, 165, 164, 0.2);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .gears-animation {
            font-size: 3.5rem;
            animation: bounce 1s ease-in-out infinite;
            text-align: center;
            margin: 24px 0;
        }
        
        @keyframes bounce {
            0%, 100% { transform: scale(1) translateY(0); }
            50% { transform: scale(1.15) translateY(-10px); }
        }
        
        .hero-section {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.08), rgba(6, 182, 212, 0.04));
            text-align: center;
            padding: 40px 20px;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(14, 165, 164, 0.1), transparent);
            border-radius: 50%;
            top: -100px;
            right: -100px;
            animation: float 6s ease-in-out infinite;
        }
        
        .hero-section::after {
            content: '';
            position: absolute;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(139, 92, 246, 0.08), transparent);
            border-radius: 50%;
            bottom: -50px;
            left: -50px;
            animation: float 8s ease-in-out infinite reverse;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(30px); }
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(400px);
                opacity: 0;
            }
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
        }
        
        .hero-content h1 {
            font-size: 4rem;
            margin-bottom: 24px;
            font-weight: 800;
            letter-spacing: -1px;
            line-height: 1.2;
        }
        
        .hero-content p {
            font-size: 1.3rem;
            color: var(--muted);
            margin-bottom: 40px;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.6;
            font-weight: 500;
        }
        
        .cta-buttons {
            display: flex;
            gap: 18px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 60px;
        }

        /* ===== ADVANCED TAILWIND UTILITY ENHANCEMENTS ===== */
        
        /* Premium Card Styles */
        .card-premium {
            background: linear-gradient(135deg, rgba(20, 24, 32, 0.8) 0%, rgba(26, 32, 44, 0.6) 100%);
            border: 1px solid rgba(14, 165, 164, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 28px;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }
        
        .card-premium::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(14, 165, 164, 0.05) 50%, transparent 70%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }
        
        .card-premium:hover {
            border-color: rgba(14, 165, 164, 0.3);
            box-shadow: 0 20px 60px rgba(14, 165, 164, 0.2);
            transform: translateY(-8px);
        }
        
        .card-premium:hover::before {
            opacity: 1;
        }

        /* Advanced Button Styles */
        .btn-gradient {
            background: linear-gradient(135deg, #0ea5a4 0%, #06b6d4 100%);
            background-size: 200% 200%;
            animation: gradient-flow 3s ease infinite;
            color: white;
            font-weight: 700;
            padding: 14px 32px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            box-shadow: 0 10px 30px rgba(14, 165, 164, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn-gradient:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 50px rgba(14, 165, 164, 0.5);
            letter-spacing: 0.5px;
        }
        
        .btn-gradient:active {
            transform: translateY(-1px);
        }

        /* Glass Morphism Effect */
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
        }

        /* Premium Input Styles */
        .input-premium {
            background: rgba(14, 165, 164, 0.03);
            border: 1.5px solid rgba(14, 165, 164, 0.1);
            border-radius: 12px;
            padding: 14px 18px;
            color: #f0f4f9;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .input-premium::placeholder {
            color: rgba(160, 174, 192, 0.5);
        }
        
        .input-premium:focus {
            outline: none;
            border-color: #0ea5a4;
            background: rgba(14, 165, 164, 0.08);
            box-shadow: 0 0 30px rgba(14, 165, 164, 0.3), inset 0 0 20px rgba(14, 165, 164, 0.05);
        }

        /* Floating Label Animation */
        .floating-label {
            position: relative;
            margin-bottom: 20px;
        }
        
        .floating-label label {
            position: absolute;
            top: -12px;
            left: 14px;
            background: linear-gradient(135deg, #080b14 0%, #0a0e1a 100%);
            padding: 0 8px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #0ea5a4;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        /* Gradient Text Animations */
        .gradient-text-animated {
            background: linear-gradient(135deg, #0ea5a4 0%, #06b6d4 50%, #8b5cf6 100%);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradient-flow 3s ease infinite;
        }

        /* Hover Glow Effect */
        .hover-glow {
            transition: all 0.3s ease;
            position: relative;
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 30px rgba(14, 165, 164, 0.5), 0 0 60px rgba(6, 182, 212, 0.3);
        }

        /* Smooth Scroll Behavior */
        html.smooth-scroll {
            scroll-behavior: smooth;
        }

        /* Advanced Loading States */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(14, 165, 164, 0.2);
            border-top-color: #0ea5a4;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Success States */
        .status-success {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.08);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.2);
        }

        /* Error States */
        .status-error {
            border-color: #ef4444;
            background: rgba(239, 68, 68, 0.08);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.2);
        }

        /* Warning States */
        .status-warning {
            border-color: #f59e0b;
            background: rgba(245, 158, 11, 0.08);
            box-shadow: 0 0 20px rgba(245, 158, 11, 0.2);
        }

        /* Smooth Transitions */
        .transition-smooth {
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Focus Ring Styles */
        .focus-ring {
            outline: none;
            box-shadow: 0 0 0 3px rgba(14, 165, 164, 0.1), 0 0 0 6px rgba(14, 165, 164, 0.05);
        }

        /* Tooltip Styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 24, 32, 0.95);
            color: #0ea5a4;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            border: 1px solid rgba(14, 165, 164, 0.3);
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }

        /* Badge Enhancement */
        .badge-premium {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.15), rgba(6, 182, 212, 0.08));
            color: #0ea5a4;
            padding: 8px 14px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            border: 1px solid rgba(14, 165, 164, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .badge-premium:hover {
            background: linear-gradient(135deg, rgba(14, 165, 164, 0.25), rgba(6, 182, 212, 0.15));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(14, 165, 164, 0.2);
        }

        /* Responsive Text Scaling */
        @media (max-width: 768px) {
            .stat-value {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 30px 20px;
            }
            
            .sidebar {
                width: 240px;
            }
            
            .main-content {
                margin-left: 240px;
            }
        }

        /* Dark Mode Enhancements */
        @media (prefers-color-scheme: dark) {
            .card-premium {
                background: linear-gradient(135deg, rgba(8, 11, 20, 0.9) 0%, rgba(10, 14, 26, 0.8) 100%);
            }
        }

        /* Accessibility Focus Indicators */
        *:focus-visible {
            outline: 2px solid #0ea5a4;
            outline-offset: 2px;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <!-- Offline Status Indicator -->
    <div id="offlineIndicator" style="display: none; position: fixed; top: 20px; right: 20px; z-index: 9999; max-width: 300px; animation: slideIn 0.3s ease-out;">
    </div>
    
    <!-- Network Status Indicator with Auto-Connect -->
    <div id="networkStatus" style="position: fixed; top: 20px; right: 20px; padding: 8px 14px; background: rgba(0,0,0,0.4); border-radius: 20px; font-size: 0.85rem; z-index: 9999; cursor: pointer; border: 1px solid rgba(14,165,164,0.3); backdrop-filter: blur(10px); transition: all 0.3s ease;" onclick="checkServerConnection(); return false;" title="Click to check connection">🟢 Online</div>

    <!-- Alerts -->
    <div class="alert alert-success" id="successAlert"></div>
    <div class="alert alert-error" id="errorAlert"></div>

    <!-- Welcome Section (Pre-Login) -->
    <section id="welcome" class="section active">
        <div class="hero-section">
            <div class="hero-content">
                <h1 class="gradient-text">Master Tomorrow's Tech, Today.</h1>
                <p>Bridge the engineering skill gap. Get certified. Land your dream job in AI, Cloud, IoT & more.</p>
                <div class="cta-buttons">
                    <button class="btn-primary" onclick="showModal('authModal')">Get Started Now</button>
                    <button class="btn-secondary" onclick="startAssessment()">Discover Your Path</button>
                    <button class="btn-secondary" onclick="showModal('authModal')">Already a user? Sign In</button>
                </div>
                <div style="margin-top: 60px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; max-width: 600px; margin-left: auto; margin-right: auto;">
                    <div class="stat-card">
                        <div class="stat-value">5000+</div>
                        <p class="text-muted mt-2" style="font-size: 0.9rem;">Students Enrolled</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">95%</div>
                        <p class="text-muted mt-2" style="font-size: 0.9rem;">Career Placement</p>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value">120+</div>
                        <p class="text-muted mt-2" style="font-size: 0.9rem;">Industry Partners</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Auth Modal -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <h2 class="text-2xl font-bold mb-6 gradient-text">Join SmartMentorAI</h2>
            <div id="authForm">
                <input class="input-field" id="authUsername" type="text" placeholder="Username">
                <input class="input-field" id="authPassword" type="password" placeholder="Password">
                <div style="display: flex; gap: 12px;">
                    <button class="btn-primary" style="flex: 1;" onclick="register()">Register</button>
                    <button class="btn-secondary" style="flex: 1;" onclick="login()">Login</button>
                </div>
                <button class="btn-secondary" style="width: 100%; margin-top: 12px;" onclick="closeModal('authModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Assessment Modal -->
    <div class="modal" id="assessmentModal">
        <div class="modal-content">
            <div class="step-indicator">
                <div class="step completed" id="step1">
                    <div class="step-number">1</div>
                    <div class="text-sm">Interests</div>
                </div>
                <div class="step" id="step2">
                    <div class="step-number">2</div>
                    <div class="text-sm">Skills</div>
                </div>
                <div class="step" id="step3">
                    <div class="step-number">3</div>
                    <div class="text-sm">Goal</div>
                </div>
            </div>

            <!-- Step 1: Interests -->
            <div id="assessmentStep1" class="assessment-step">
                <h3 class="text-xl font-bold mb-6 gradient-text">What are your engineering interests?</h3>
                <div class="interest-grid" id="interestGrid">
                    <div class="interest-card" onclick="selectInterest(this, 'AI')">
                        <div class="interest-icon">🤖</div>
                        <div>Artificial Intelligence</div>
                    </div>
                    <div class="interest-card" onclick="selectInterest(this, 'Cloud')">
                        <div class="interest-icon">☁️</div>
                        <div>Cloud Computing</div>
                    </div>
                    <div class="interest-card" onclick="selectInterest(this, 'IoT')">
                        <div class="interest-icon">📡</div>
                        <div>Internet of Things</div>
                    </div>
                    <div class="interest-card" onclick="selectInterest(this, 'Cyber')">
                        <div class="interest-icon">Lock</div>
                        <div>Cybersecurity</div>
                    </div>
                    <div class="interest-card" onclick="selectInterest(this, 'Data')">
                        <div class="interest-icon">Chart</div>
                        <div>Data Science</div>
                    </div>
                    <div class="interest-card" onclick="selectInterest(this, 'Green')">
                        <div class="interest-icon">♻️</div>
                        <div>Green Tech</div>
                    </div>
                </div>
                <button class="btn-primary" style="width: 100%; margin-top: 20px;" onclick="nextAssessmentStep()">Next</button>
            </div>

            <!-- Step 2: Skills -->
            <div id="assessmentStep2" class="assessment-step" style="display: none;">
                <h3 class="text-xl font-bold mb-6 gradient-text">Tell us about your current skills</h3>
                
                <div class="skill-slider">
                    <label>Python Programming</label>
                    <input type="range" id="pythonSkill" min="0" max="2" value="0">
                    <div style="color: var(--muted); font-size: 0.9rem;" id="pythonLevel">Beginner</div>
                </div>

                <div class="skill-slider">
                    <label>Web Development</label>
                    <input type="range" id="webSkill" min="0" max="2" value="0">
                    <div style="color: var(--muted); font-size: 0.9rem;" id="webLevel">Beginner</div>
                </div>

                <div class="skill-slider">
                    <label>Database Design</label>
                    <input type="range" id="dbSkill" min="0" max="2" value="0">
                    <div style="color: var(--muted); font-size: 0.9rem;" id="dbLevel">Beginner</div>
                </div>

                <script>
                    document.getElementById('pythonSkill').addEventListener('input', (e) => {
                        const levels = ['Beginner', 'Intermediate', 'Advanced'];
                        document.getElementById('pythonLevel').textContent = levels[e.target.value];
                    });
                    document.getElementById('webSkill').addEventListener('input', (e) => {
                        const levels = ['Beginner', 'Intermediate', 'Advanced'];
                        document.getElementById('webLevel').textContent = levels[e.target.value];
                    });
                    document.getElementById('dbSkill').addEventListener('input', (e) => {
                        const levels = ['Beginner', 'Intermediate', 'Advanced'];
                        document.getElementById('dbLevel').textContent = levels[e.target.value];
                    });
                </script>

                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button class="btn-secondary" style="flex: 1;" onclick="prevAssessmentStep()">Back</button>
                    <button class="btn-primary" style="flex: 1;" onclick="nextAssessmentStep()">Next</button>
                </div>
            </div>

            <!-- Step 3: Goal -->
            <div id="assessmentStep3" class="assessment-step" style="display: none;">
                <h3 class="text-xl font-bold mb-6 gradient-text">What's your career goal?</h3>
                
                <label style="display: block; margin-bottom: 10px; font-weight: 600;">Select your goal:</label>
                <select class="input-field" id="careerGoal">
                    <option>Fresh Graduate Job</option>
                    <option>Career Transition</option>
                    <option>Project-Based Learning</option>
                    <option>Certification</option>
                    <option>Upskilling</option>
                </select>

                <label style="display: block; margin-bottom: 10px; font-weight: 600;">Expected salary range (optional):</label>
                <input type="text" class="input-field" placeholder="e.g., 50-70 LPA">

                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button class="btn-secondary" style="flex: 1;" onclick="prevAssessmentStep()">Back</button>
                    <button class="btn-primary" style="flex: 1;" onclick="completeAssessment()">Generate My Path</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Section (Post-Login) -->
    <section id="dashboard" class="section">
        <div class="sidebar-layout">
            <!-- Sidebar Navigation -->
            <div class="sidebar">
                <h2 class="text-xl font-bold mb-6 gradient-text">SmartMentorAI</h2>
                <ul class="sidebar-nav">
                    <li><a href="#" class="nav-link active" onclick="switchDashboard('overview')"> Dashboard</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('courses')">My Learning</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('projects')">My Projects</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('lab')">Skill Labs</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('interview')">Mock Interview</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('aitutor')">AI Tutor</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('career')">Career Zone</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('community')">Community</a></li>
                    <li><a href="#" class="nav-link" onclick="switchDashboard('blockchain')">🔗 Blockchain Credentials</a></li>
                </ul>
                <hr style="border-color: rgba(14, 165, 164, 0.1); margin: 20px 0;">
                <button class="btn-secondary" style="width: 100%;" onclick="logout()">Logout</button>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Overview -->
                <div id="overview" class="dashboard-view active">
                    <h1 class="text-4xl font-bold mb-2 gradient-text">Welcome back, <span id="dashboardUsername">User</span>!</h1>
                    <p style="color: var(--muted); margin-bottom: 30px;">Your Future-Ready Path Awaits</p>

                    <!-- Stats Grid -->
                    <div class="grid-3" style="margin-bottom: 40px;">
                        <div class="stat-card card-premium hover-glow">
                            <div class="stat-value" id="statPoints">0</div>
                            <p style="color: var(--muted); margin-top: 10px;">Points Earned</p>
                        </div>
                        <div class="stat-card card-premium hover-glow">
                            <div class="stat-value" id="statBadges">0</div>
                            <p style="color: var(--muted); margin-top: 10px;">Badges Unlocked</p>
                        </div>
                        <div class="stat-card card-premium hover-glow">
                            <div class="stat-value" id="statStreak">0</div>
                            <p style="color: var(--muted); margin-top: 10px;">Day Streak</p>
                        </div>
                    </div>

                    <!-- Recommended Path -->
                    <h2 class="text-2xl font-bold mb-4">Your Recommended Path</h2>
                    <div class="card card-premium hover-glow" style="margin-bottom: 40px;">
                        <h3 class="text-xl font-bold mb-3" id="recommendedCourse">Applied Machine Learning</h3>
                        <p style="color: var(--muted); margin-bottom: 15px;">Master modern ML techniques with real-world applications</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 25%;"></div>
                        </div>
                        <p style="color: var(--muted); font-size: 0.9rem; margin-top: 10px;">25% Complete</p>
                        <button class="btn-primary" style="margin-top: 15px; width: 100%;" onclick="switchDashboard('courses')">Continue Learning →</button>
                    </div>

                    <!-- Skill Snapshot -->
                    <!-- Skill Snapshot & Analytics -->
                    <h2 class="text-2xl font-bold mb-4">Skill Snapshot & Analytics</h2>
                    <div class="grid-2">
                        <div class="card card-premium hover-glow">
                            <h4 class="font-bold mb-3">Your Skills (5 Core Areas)</h4>
                            <div style="height: 250px;">
                                <canvas id="skillChart"></canvas>
                            </div>
                        </div>
                        <div class="card card-premium hover-glow">
                            <h4 class="font-bold mb-3">Weekly Learning Progress</h4>
                            <div style="height: 250px;">
                                <canvas id="learningChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Activity Analytics -->
                    <h2 class="text-2xl font-bold mb-4 mt-8">Activity Analytics</h2>
                    <div class="grid-2" style="margin-bottom: 40px;">
                        <div class="card card-premium hover-glow">
                            <h4 class="font-bold mb-3">Daily Activity (Minutes)</h4>
                            <div style="height: 250px;">
                                <canvas id="activityChart"></canvas>
                            </div>
                        </div>
                        <div class="card card-premium hover-glow">
                            <h4 class="font-bold mb-3">Course Progress</h4>
                            <div style="height: 250px;">
                                <canvas id="courseProgressChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics Summary -->
                    <h2 class="text-2xl font-bold mb-4">Learning Statistics</h2>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 40px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Labs Completed</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="statsLabsCompleted">3</p>
                            <p style="color: var(--success); font-size: 0.85rem;">+2 this week</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Projects Done</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="statsProjectsCompleted">5</p>
                            <p style="color: var(--success); font-size: 0.85rem;">+1 this week</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Learning Hours</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="statsLearningHours">45</p>
                            <p style="color: var(--success); font-size: 0.85rem;">+8 this week</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Interview Score</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="statsInterviewScore">75%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">+5% improvement</p>
                        </div>
                    </div>
                </div>

                <!-- Courses View -->
                <div id="courses" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">My Learning Path</h1>
                    
                    <!-- Course Progress Overview -->
                    <h2 class="text-xl font-bold mb-4">Overall Progress</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <div>
                                <p style="color: var(--muted); font-size: 0.9rem;">Total Completion</p>
                                <p class="gradient-text" style="font-size: 2rem; font-weight: bold; margin-top: 5px;" id="overallProgress">55%</p>
                            </div>
                            <div style="text-align: right;">
                                <p style="color: var(--success); font-weight: 600;">On Track</p>
                                <p style="color: var(--muted); font-size: 0.85rem;">3 courses active</p>
                            </div>
                        </div>
                        <div class="progress-bar" style="height: 8px; margin-bottom: 10px;">
                            <div class="progress-fill" style="width: 55%; background: linear-gradient(90deg, #0ea5a4, #06b6d4);"></div>
                        </div>
                        <div style="display: flex; justify-content: space-between; color: var(--muted); font-size: 0.85rem;">
                            <span>55% Complete</span>
                            <span id="estimatedTime">8 hours remaining</span>
                        </div>
                    </div>

                    <!-- Course Cards -->
                    <h2 class="text-xl font-bold mb-4">Your Courses</h2>
                    <div class="grid-2" id="coursesList"></div>
                </div>

                <!-- Projects View -->
                <div id="projects" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">My Projects</h1>
                    
                    <!-- Project Analytics -->
                    <h2 class="text-xl font-bold mb-4">Project Analytics</h2>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">In Progress</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;">2</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Active projects</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Completed</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;">5</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Portfolio ready</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Rating</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;">4.7 Stars</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">From mentors</p>
                        </div>
                    </div>
                    
                    <h2 class="text-xl font-bold mb-4 mt-8">In Progress</h2>
                    <div class="grid-2" id="inProgressProjects">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">IoT Smart Home Prototype</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Status: Pending Mentor Review</p>
                            <p style="color: var(--muted); font-size: 0.85rem;">Deadline: July 20, 2025</p>
                            <button class="btn-primary" style="width: 100%; margin-top: 15px;" onclick="goToProjectWorkspace('IoT Smart Home Prototype')">Go to Project Workspace</button>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Customer Churn Prediction</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Company: TechCorp Inc.</p>
                            <p style="color: var(--muted); font-size: 0.85rem;">Status: Data Cleaning Phase</p>
                            <button class="btn-primary" style="width: 100%; margin-top: 15px;" onclick="continueProject('Customer Churn Prediction')">Continue Project</button>
                        </div>
                    </div>

                    <h2 class="text-xl font-bold mb-4 mt-8">Completed</h2>
                    <div class="grid-2" id="completedProjects">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Image Classification with CNNs</h3>
                            <div style="margin: 10px 0;">
                                <span class="badge">#DeepLearning</span>
                                <span class="badge">#Python</span>
                                <span class="badge">#ComputerVision</span>
                            </div>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-top: 10px;">Rating: 4.8/5</p>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="addToPortfolio('Image Classification with CNNs')">Add to Portfolio</button>
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="viewProjectFeedback('Image Classification with CNNs')">View Feedback</button>
                            </div>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Real-time Chat Application</h3>
                            <div style="margin: 10px 0;">
                                <span class="badge">#WebDev</span>
                                <span class="badge">#React</span>
                                <span class="badge">#Firebase</span>
                            </div>
                            <p style="color: var(--success); font-size: 0.9rem; margin-top: 10px;">+ In Portfolio</p>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="viewProjectFeedback('Real-time Chat Application')">View Feedback</button>
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="viewProjectCode('Real-time Chat Application')">View Code</button>
                            </div>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Stock Price Prediction API</h3>
                            <div style="margin: 10px 0;">
                                <span class="badge">#API</span>
                                <span class="badge">#Python</span>
                                <span class="badge">#DataScience</span>
                            </div>
                            <p style="color: var(--success); font-size: 0.9rem; margin-top: 10px;">+ In Portfolio</p>
                            <div style="display: flex; gap: 10px; margin-top: 15px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="viewProjectFeedback('Stock Price Prediction API')">View Feedback</button>
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="viewProjectCode('Stock Price Prediction API')">View Code</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Lab View -->
                <!-- Lab View -->
                <div id="lab" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">Skill Labs</h1>
                    
                    <!-- Lab Statistics -->
                    <h2 class="text-xl font-bold mb-4">Your Lab Performance</h2>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Labs Attempted</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="labsAttempted">8</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Total labs</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Success Rate</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="labSuccessRate">87.5%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">7 passed</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Time</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="labAvgTime">35 min</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Per lab</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Score</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="labAvgScore">82%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Good performance</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div class="card">
                            <h3 class="text-xl font-bold mb-4">Lab Instructions</h3>
                            <h4 class="font-bold mb-3">Problem: Implement Linear Regression</h4>
                            <p style="color: var(--muted); margin-bottom: 15px; line-height: 1.6;">
                                Build a linear regression model to predict house prices based on provided features. Use the training dataset and validate your model on the test set.
                            </p>
                            <h4 class="font-bold mb-3">Key Steps:</h4>
                            <ol style="color: var(--muted); margin-left: 20px; line-height: 1.8;">
                                <li>Load and explore the dataset</li>
                                <li>Preprocess features (normalize if needed)</li>
                                <li>Train a linear regression model</li>
                                <li>Evaluate using R² score</li>
                                <li>Make predictions on test data</li>
                            </ol>
                        </div>
                        <div class="card">
                            <h3 class="text-xl font-bold mb-4">Code Editor</h3>
                            <textarea id="labCode" class="input-field" style="height: 300px; font-family: monospace; font-size: 0.9rem;" placeholder="# Write your Python code here...
import pandas as pd
from sklearn.linear_model import LinearRegression

# Load data
data = pd.read_csv('data.csv')"></textarea>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-primary" style="flex: 1;" onclick="runLabCode()">▶ Run Code</button>
                                <button class="btn-secondary" style="flex: 1;" onclick="submitLab()">Submit</button>
                            </div>
                        </div>
                    </div>
                    <div class="card" style="margin-top: 20px;">
                        <h3 class="text-xl font-bold mb-4">Output</h3>
                        <div id="labOutput" style="background: #0a0e1a; padding: 16px; border-radius: 8px; min-height: 150px; font-family: monospace; font-size: 0.9rem; color: var(--success); overflow-y: auto;">
                            Console output will appear here...
                        </div>
                    </div>
                </div>

                <!-- Career View -->
                <div id="career" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">Career Zone</h1>
                    
                    <!-- Career Analytics -->
                    <h2 class="text-xl font-bold mb-4">Your Career Impact</h2>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Profile Views</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="profileViews">143</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">This month</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Job Matches</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="jobMatches">12</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Matching roles</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Applications</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="jobApplications">7</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Pending replies</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Response Rate</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="responseRate">58%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Good engagement</p>
                        </div>
                    </div>
                    
                    <h2 class="text-xl font-bold mb-4">My Digital Portfolio</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <p style="color: var(--muted); margin-bottom: 15px;">Your professional presence, elevated</p>
                        <div style="background: rgba(14, 165, 164, 0.05); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                            <p style="color: var(--muted); font-size: 0.9rem;">Public Portfolio Link:</p>
                            <p style="font-weight: 600; color: var(--primary);">smartmentorai.io/user/<span id="portfolioUsername">user</span></p>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-primary" style="flex: 1;" onclick="editPortfolio()">Edit Portfolio</button>
                            <button class="btn-secondary" style="flex: 1;" onclick="sharePortfolioLink()">Share Link</button>
                        </div>
                    </div>

                    <h2 class="text-xl font-bold mb-4">Interview Preparation</h2>
                    <div class="grid-2" style="margin-bottom: 30px;">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-3">Mock Interview Simulator</h3>
                            <p style="color: var(--muted); margin-bottom: 15px;">Practice with AI-powered interviews for Data Scientist role</p>
                            <button class="btn-primary" style="width: 100%;" onclick="switchDashboard('interview')">Launch Simulator</button>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-bold mb-3">Common Questions</h3>
                            <p style="color: var(--muted); margin-bottom: 15px;">Review curated technical & behavioral questions</p>
                            <button class="btn-primary" style="width: 100%;" onclick="viewCommonQuestions()">View Questions</button>
                        </div>
                    </div>

                    <h2 class="text-xl font-bold mb-4">Job Board (Exclusive Listings)</h2>
                    <div class="grid-2" id="jobBoard">
                        <div class="card">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <h3 class="text-lg font-bold">Data Scientist - Entry Level</h3>
                                <span style="background: rgba(14, 165, 164, 0.2); color: var(--primary); padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">Hot</span>
                            </div>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Analytics Solutions | Hyderabad</p>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 10px; border-radius: 6px; margin: 10px 0;">
                                <p style="color: var(--primary); font-weight: 600;">6-8 LPA</p>
                                <p style="color: var(--primary); font-weight: 600;">⚡ Skills Match: 85%</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="showJobDetails(1)">Details</button>
                                <button class="btn-primary" style="flex: 1; font-size: 0.85rem;" onclick="applyForJob('Data Scientist - Entry Level')">✉️ Apply</button>
                            </div>
                        </div>
                        <div class="card">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <h3 class="text-lg font-bold">ML Engineer</h3>
                                <span style="background: rgba(59, 130, 246, 0.2); color: #3b82f6; padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">Featured</span>
                            </div>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Tech Innovations | Bangalore</p>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 10px; border-radius: 6px; margin: 10px 0;">
                                <p style="color: var(--primary); font-weight: 600;">10-14 LPA</p>
                                <p style="color: var(--primary); font-weight: 600;">⚡ Skills Match: 72%</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="showJobDetails(2)">Details</button>
                                <button class="btn-primary" style="flex: 1; font-size: 0.85rem;" onclick="applyForJob('ML Engineer')">✉️ Apply</button>
                            </div>
                        </div>
                        <div class="card">
                            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                <h3 class="text-lg font-bold">Python Developer</h3>
                                <span style="background: rgba(16, 185, 129, 0.2); color: var(--success); padding: 4px 10px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">New</span>
                            </div>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Web Systems Ltd | Remote</p>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 10px; border-radius: 6px; margin: 10px 0;">
                                <p style="color: var(--primary); font-weight: 600;">7-10 LPA</p>
                                <p style="color: var(--primary); font-weight: 600;">⚡ Skills Match: 78%</p>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="btn-secondary" style="flex: 1; font-size: 0.85rem;" onclick="showJobDetails(3)">Details</button>
                                <button class="btn-primary" style="flex: 1; font-size: 0.85rem;" onclick="applyForJob('Python Developer')">✉️ Apply</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mock Interview View -->
                <div id="interview" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">Mock Interview Simulator</h1>
                    <p style="color: var(--muted); margin-bottom: 30px;">Interviewing for: Data Scientist Role</p>
                    
                    <!-- Interview Performance Stats -->
                    <h2 class="text-xl font-bold mb-4">Your Interview Performance</h2>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Interviews Done</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="interviewsDone">12</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Mock sessions</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Best Score</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="bestScore">92%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Excellent</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Score</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="avgInterviewScore">78%</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Good average</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Improvement</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="scoreImprovement">+15%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">From first attempt</p>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px;">
                        <div class="card">
                            <h3 class="text-xl font-bold mb-4">Interview Session</h3>
                            <div id="interviewPrompt" style="background: rgba(14, 165, 164, 0.05); padding: 20px; border-radius: 8px; margin-bottom: 20px; min-height: 100px;">
                                <p style="color: var(--muted); margin-bottom: 15px;"><strong>Interviewer:</strong></p>
                                <p>"Please describe a time you faced a significant technical challenge in a data science project and how you overcame it."</p>
                            </div>
                            
                            <div id="cameraContainer" style="background: #0a0e1a; padding: 15px; border-radius: 8px; margin-bottom: 20px; aspect-ratio: 16/9; border: 2px solid rgba(14, 165, 164, 0.5); display: flex; align-items: center; justify-content: center; position: relative; overflow: hidden;">
                                <video id="webcam" autoplay playsinline muted style="width: 100%; height: 100%; object-fit: cover; display: none; background: #000; visibility: visible;"></video>
                                <div id="cameraPlaceholder" style="text-align: center; color: var(--primary); font-size: 1.1rem;">
                                    Webcam Feed<br><small>(Click "Start Recording" to access camera)</small>
                                </div>
                            </div>

                            <div style="display: flex; gap: 10px;">
                                <button class="btn-primary" style="flex: 1;" onclick="startInterview()">Start Recording</button>
                                <button class="btn-secondary" id="stopInterview" style="flex: 1; display: none;" onclick="stopInterview()">⏹ Stop Recording</button>
                            </div>
                        </div>

                        <div class="card">
                            <h3 class="text-lg font-bold mb-4">Interview Info</h3>
                            <div style="margin-bottom: 20px;">
                                <p style="color: var(--muted); font-size: 0.9rem;">Time Remaining</p>
                                <p style="font-size: 1.5rem; font-weight: bold; color: var(--primary);" id="timer">5:00</p>
                            </div>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 15px; border-radius: 8px;">
                                <p style="color: var(--muted); font-size: 0.85rem;">Questions Answered</p>
                                <p style="font-size: 1.5rem; font-weight: bold; color: var(--primary);">1/5</p>
                            </div>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 20px; display: none;" id="feedbackCard">
                        <h3 class="text-xl font-bold mb-4">Interview Feedback</h3>
                        <div class="grid-2">
                            <div>
                                <p style="color: var(--muted); margin-bottom: 10px;">Overall Score</p>
                                <p style="font-size: 2rem; font-weight: bold; color: var(--primary);">75/100</p>
                            </div>
                            <div>
                                <p style="color: var(--muted); margin-bottom: 10px;">Key Improvements</p>
                                <ul style="color: var(--muted); list-style: none;">
                                    <li>+ Technical Accuracy</li>
                                    <li>- Clarity & Conciseness</li>
                                    <li>- Confidence Level</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Community View -->
                <div id="community" class="dashboard-view" style="display: none;">
                    <h1 class="text-3xl font-bold mb-6 gradient-text">Community</h1>
                    <p style="color: var(--muted); margin-bottom: 30px;">Connect with fellow learners and experts</p>
                    
                    <!-- Community Discussion Forums -->
                    <h2 class="text-xl font-bold mb-4">Discussion Forums</h2>
                    <div class="grid-2" style="margin-bottom: 30px;">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Python Experts</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Ask questions, share tips, and discuss Python best practices</p>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 10px; border-radius: 6px; margin-bottom: 15px;">
                                <p style="color: var(--primary); font-size: 0.85rem;">2,450 members • 15.2K posts</p>
                            </div>
                            <button class="btn-primary" style="width: 100%;" onclick="viewCommunityForum('Python Experts')">Join Discussion</button>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-bold mb-2">Data Science</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Discuss ML models, datasets, and data analysis techniques</p>
                            <div style="background: rgba(14, 165, 164, 0.1); padding: 10px; border-radius: 6px; margin-bottom: 15px;">
                                <p style="color: var(--primary); font-size: 0.85rem;">3,120 members • 22.8K posts</p>
                            </div>
                            <button class="btn-primary" style="width: 100%;" onclick="viewCommunityForum('Data Science')">Join Discussion</button>
                        </div>
                    </div>

                    <!-- Give Feedback Section -->
                    <h2 class="text-xl font-bold mb-4">Send Feedback & Suggestions</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <p style="color: var(--muted); margin-bottom: 20px;">We'd love to hear from you! Share your thoughts, suggestions, and feedback to help us improve SmartMentorAI Pro.</p>
                        <div style="background: rgba(14, 165, 164, 0.05); padding: 20px; border-radius: 12px;">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Feedback Type</label>
                                <select id="feedbackType" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(14, 165, 164, 0.3); border-radius: 6px; color: var(--text); font-size: 1rem;">
                                    <option value="">-- Select Type --</option>
                                    <option value="bug">Bug Report</option>
                                    <option value="feature">Feature Request</option>
                                    <option value="improvement">⚡ Improvement</option>
                                    <option value="content">Content Suggestion</option>
                                    <option value="other">Other Feedback</option>
                                </select>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Your Email</label>
                                <input type="email" id="feedbackEmail" class="input-field" placeholder="your.email@example.com">
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Detailed Feedback</label>
                                <textarea id="feedbackText" class="input-field" style="height: 150px; font-family: inherit; font-size: 1rem; resize: vertical;" placeholder="Please share your detailed feedback or suggestions..."></textarea>
                            </div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <button class="btn-primary" style="width: 100%;" onclick="submitFeedback()">✉️ Submit Feedback</button>
                                <button class="btn-secondary" style="width: 100%;" onclick="clearFeedbackForm()">Clear Form</button>
                            </div>
                        </div>
                    </div>

                    <!-- Community Features Coming Soon -->
                    <h2 class="text-xl font-bold mb-4">More Features Coming Soon!</h2>
                    <div class="card">
                        <h3 class="text-lg font-bold mb-4">Community Features</h3>
                        <div style="background: rgba(14, 165, 164, 0.1); padding: 20px; border-radius: 12px;">
                            <h4 style="font-weight: 600; color: var(--primary); margin-bottom: 15px;">What's Coming:</h4>
                            <ul style="color: var(--muted); list-style: none; line-height: 2;">
                                <li>+ Study groups and collaborative projects</li>
                                <li>+ Peer code reviews and feedback</li>
                                <li>+ Knowledge sharing articles</li>
                                <li>+ Networking events and meetups</li>
                                <li>+ Community mentorship program</li>
                                <li>+ Badges & reputation system</li>
                            </ul>
                        </div>
                        <button class="btn-primary" style="width: 100%; margin-top: 20px;" onclick="viewCommunity()">Learn More</button>
                    </div>
                </div>

                <!-- Blockchain Credentials View -->
                <div id="blockchain" class="dashboard-view" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <div>
                            <h1 class="text-3xl font-bold mb-2 gradient-text">🔗 Blockchain Credentials</h1>
                            <p style="color: var(--muted); margin-bottom: 20px;">Secure, verifiable credentials on the blockchain. Earn NFTs and certificates for your achievements.</p>
                        </div>
                    </div>

                    <!-- Blockchain Address Section -->
                    <div class="grid-2" style="margin-bottom: 30px;">
                        <div class="card">
                            <h3 class="text-lg font-bold mb-3">Your Blockchain Address</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Your unique Web3 identity:</p>
                            <div id="blockchainAddress" style="background: rgba(14, 165, 164, 0.1); padding: 15px; border-radius: 8px; border: 1px solid rgba(14, 165, 164, 0.3); word-break: break-all; font-family: monospace; font-size: 0.85rem; color: var(--primary); margin-bottom: 15px;">
                                Loading...
                            </div>
                            <button class="btn-primary" style="width: 100%; font-size: 0.9rem;" onclick="generateBlockchainAddress()">Generate Address</button>
                        </div>

                        <div class="card">
                            <h3 class="text-lg font-bold mb-3">Blockchain Statistics</h3>
                            <div id="blockchainStats" style="color: var(--muted);">
                                <p style="margin-bottom: 8px;">🔐 Transactions: <span style="color: var(--primary); font-weight: 600;">-</span></p>
                                <p style="margin-bottom: 8px;">✅ Verified Users: <span style="color: var(--primary); font-weight: 600;">-</span></p>
                                <p style="margin-bottom: 8px;">🏆 Achievements: <span style="color: var(--primary); font-weight: 600;">-</span></p>
                                <p style="margin-bottom: 15px;">💎 Total Points Issued: <span style="color: var(--primary); font-weight: 600;">-</span></p>
                            </div>
                            <button class="btn-secondary" style="width: 100%; font-size: 0.9rem;" onclick="loadBlockchainStats()">Refresh Stats</button>
                        </div>
                    </div>

                    <!-- Achievement Certificates Section -->
                    <h2 class="text-xl font-bold mb-4">Achievement Certificates</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <p style="color: var(--muted); margin-bottom: 20px;">Issue blockchain-verified achievement certificates with NFT metadata:</p>
                        <div style="background: rgba(14, 165, 164, 0.05); padding: 20px; border-radius: 12px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                <div>
                                    <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Achievement Title</label>
                                    <input type="text" id="achievementTitle" class="input-field" placeholder="e.g., Python Master">
                                </div>
                                <div>
                                    <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Points Earned</label>
                                    <input type="number" id="achievementPoints" class="input-field" placeholder="500">
                                </div>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Description</label>
                                <textarea id="achievementDescription" class="input-field" style="height: 100px; resize: vertical;" placeholder="Describe the achievement..."></textarea>
                            </div>
                            <button class="btn-primary" style="width: 100%;" onclick="issueBlockchainAchievement()">🔗 Issue Blockchain Certificate</button>
                        </div>
                    </div>

                    <!-- Verifiable Credentials -->
                    <h2 class="text-xl font-bold mb-4">Verifiable Credentials</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <p style="color: var(--muted); margin-bottom: 20px;">Generate W3C-compliant verifiable credentials for your achievements:</p>
                        <button class="btn-primary" style="width: 100%;" onclick="generateVerifiableCredential()">📜 Generate Credential</button>
                        <div id="credentialOutput" style="background: rgba(14, 165, 164, 0.1); padding: 15px; border-radius: 8px; margin-top: 15px; display: none; max-height: 300px; overflow-y: auto;">
                            <pre id="credentialJSON" style="font-size: 0.85rem; color: var(--primary);"></pre>
                        </div>
                    </div>

                    <!-- NFT Badges -->
                    <h2 class="text-xl font-bold mb-4">NFT Achievement Badges</h2>
                    <div class="grid-3" style="margin-bottom: 30px;">
                        <div class="card">
                            <h3 style="font-weight: 600; color: var(--primary); margin-bottom: 10px;">⭐ NFT Metadata</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Create ERC-721 compliant NFT metadata</p>
                            <button class="btn-primary" style="width: 100%; font-size: 0.9rem;" onclick="createNFTMetadata()">Create NFT</button>
                        </div>
                        <div class="card">
                            <h3 style="font-weight: 600; color: var(--primary); margin-bottom: 10px;">🔗 Transaction</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Create blockchain transaction record</p>
                            <button class="btn-primary" style="width: 100%; font-size: 0.9rem;" onclick="createBlockchainTransaction()">Record Transaction</button>
                        </div>
                        <div class="card">
                            <h3 style="font-weight: 600; color: var(--primary); margin-bottom: 10px;">✅ Verify</h3>
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">Verify transaction on blockchain</p>
                            <button class="btn-primary" style="width: 100%; font-size: 0.9rem;" onclick="verifyBlockchainTransaction()">Verify</button>
                        </div>
                    </div>

                    <!-- Smart Contracts -->
                    <h2 class="text-xl font-bold mb-4">Smart Contract Interaction</h2>
                    <div class="card">
                        <p style="color: var(--muted); margin-bottom: 20px;">Interact with SmartMentorAI smart contracts for achievement verification and NFT minting:</p>
                        <div style="background: rgba(14, 165, 164, 0.05); padding: 20px; border-radius: 12px;">
                            <div style="margin-bottom: 15px;">
                                <label style="display: block; color: var(--muted); margin-bottom: 8px; font-weight: 600;">Function Name</label>
                                <select id="contractFunction" class="input-field">
                                    <option value="">-- Select Function --</option>
                                    <option value="issueAchievement">Issue Achievement</option>
                                    <option value="verifyCertificate">Verify Certificate</option>
                                    <option value="updateLeaderboard">Update Leaderboard</option>
                                    <option value="mintNFT">Mint Achievement NFT</option>
                                </select>
                            </div>
                            <button class="btn-primary" style="width: 100%;" onclick="executeSmartContract()">⚙️ Execute Contract</button>
                        </div>
                    </div>
                </div>

                <!-- AI Tutor View -->
                <div id="aitutor" class="dashboard-view" style="display: none;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                        <div>
                            <h1 class="text-3xl font-bold mb-6 gradient-text">AI Tutor - Personalized Learning Assistant</h1>
                            <p style="color: var(--muted); margin-bottom: 20px;">Get instant help, explanations, and solutions from our ChatGPT-powered tutor</p>
                        </div>
                        <button class="btn-secondary" style="padding: 12px 20px; cursor: pointer;" onclick="showChatGPTSettings()">⚙️ ChatGPT Settings</button>
                    </div>
                    
                    <!-- ChatGPT Setup Notice -->
                    <div id="chatgptSetupNotice" style="background: linear-gradient(135deg, rgba(14, 165, 164, 0.15), rgba(139, 92, 246, 0.1)); border: 2px solid rgba(14, 165, 164, 0.4); border-radius: 12px; padding: 20px; margin-bottom: 25px; display: none;">
                        <div style="display: flex; gap: 15px; align-items: flex-start;">
                            <span style="font-size: 2rem;">🚀</span>
                            <div style="flex: 1;">
                                <h3 style="color: var(--primary); font-weight: 700; margin-bottom: 8px; font-size: 1.1rem;">Unlock ChatGPT AI Tutor</h3>
                                <p style="color: var(--muted); margin-bottom: 12px; line-height: 1.6;">Your AI Tutor works offline, but you can unlock more powerful ChatGPT responses by connecting your API key. Get instant, personalized explanations for any coding question.</p>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <button class="btn-primary" style="padding: 10px 18px; font-size: 0.9rem;" onclick="showChatGPTSettings()">⚙️ Configure API Key Now</button>
                                    <button class="btn-secondary" style="padding: 10px 18px; font-size: 0.9rem;" onclick="document.getElementById('chatgptSetupNotice').style.display='none'">Dismiss</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- AI Tutor Stats -->
                    <h2 class="text-xl font-bold mb-4">Your Tutor Session Stats</h2>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px;">
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Problems Solved</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="problemsSolved">24</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">With AI help</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Topics Covered</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="topicsCovered">18</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Learning diversity</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Avg Time/Problem</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="avgTimeProblem">12 min</p>
                            <p style="color: var(--primary); font-size: 0.85rem;">Quick solutions</p>
                        </div>
                        <div class="card" style="text-align: center;">
                            <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 10px;">Understanding Score</p>
                            <p class="gradient-text" style="font-size: 2.5rem; font-weight: bold; margin: 10px 0;" id="understandingScore">87%</p>
                            <p style="color: var(--success); font-size: 0.85rem;">Excellent grasp</p>
                        </div>
                    </div>

                    <!-- Problem Input Section -->
                    <h2 class="text-xl font-bold mb-4">Ask the AI Tutor</h2>
                    <div class="card" style="margin-bottom: 30px;">
                        <p style="color: var(--muted); margin-bottom: 15px;">Describe your problem or ask any coding/technical question</p>
                        <textarea id="tutorProblem" style="width: 100%; height: 120px; padding: 12px; background: rgba(14, 165, 164, 0.05); border: 1px solid rgba(14, 165, 164, 0.3); border-radius: 8px; color: var(--text); font-family: inherit; margin-bottom: 15px; resize: vertical;" placeholder="Example: How do I implement a binary search algorithm? I'm stuck on the partition logic..."></textarea>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-primary" style="flex: 1;" onclick="askAITutor()">Ask AI Tutor</button>
                            <button class="btn-secondary" style="flex: 1;" onclick="getCodeHint()">Get Code Hint</button>
                            <button class="btn-secondary" style="flex: 1;" onclick="getExplanation()">Get Explanation</button>
                        </div>
                    </div>

                    <!-- AI Response Section -->
                    <h2 class="text-xl font-bold mb-4">AI Tutor Response</h2>
                    <div class="card" id="tutorResponseBox" style="display: none;">
                        <div style="background: rgba(14, 165, 164, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            <p style="color: var(--muted); font-weight: 600; margin-bottom: 12px;">AI Tutor Says:</p>
                            <p id="tutorResponse" style="color: var(--text); line-height: 1.8; margin-bottom: 15px;"></p>
                            <div id="codeSnippet" style="background: #0a0e1a; padding: 12px; border-radius: 6px; overflow-x: auto; display: none;">
                                <p style="color: var(--muted); font-size: 0.85rem; margin-bottom: 8px;">Code Example:</p>
                                <pre id="snippetCode" style="color: var(--success); font-family: monospace; font-size: 0.85rem; margin: 0;"></pre>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn-secondary" style="flex: 1;" onclick="rateTutorResponse('helpful')">Helpful</button>
                            <button class="btn-secondary" style="flex: 1;" onclick="rateTutorResponse('needsimprovement')">Needs Improvement</button>
                            <button class="btn-secondary" style="flex: 1;" onclick="clearTutorResponse()">Clear</button>
                        </div>
                    </div>

                    <!-- Suggested Topics -->
                    <h2 class="text-xl font-bold mb-4 mt-8">Suggested Learning Topics</h2>
                    <div class="grid-2">
                        <div class="card" style="cursor: pointer;" onclick="loadTutorTopic('Data Structures')">
                            <h3 class="text-lg font-bold mb-2">Data Structures</h3>
                            <p style="color: var(--muted); font-size: 0.9rem;">Arrays, Linked Lists, Trees, Graphs, Hash Maps</p>
                            <p style="color: var(--primary); font-size: 0.85rem; margin-top: 10px;">Click to learn →</p>
                        </div>
                        <div class="card" style="cursor: pointer;" onclick="loadTutorTopic('Algorithms')">
                            <h3 class="text-lg font-bold mb-2">⚡ Algorithms</h3>
                            <p style="color: var(--muted); font-size: 0.9rem;">Sorting, Searching, Dynamic Programming, Greedy</p>
                            <p style="color: var(--primary); font-size: 0.85rem; margin-top: 10px;">Click to learn →</p>
                        </div>
                        <div class="card" style="cursor: pointer;" onclick="loadTutorTopic('Web Development')">
                            <h3 class="text-lg font-bold mb-2">Web Development</h3>
                            <p style="color: var(--muted); font-size: 0.9rem;">HTML, CSS, JavaScript, React, APIs</p>
                            <p style="color: var(--primary); font-size: 0.85rem; margin-top: 10px;">Click to learn →</p>
                        </div>
                        <div class="card" style="cursor: pointer;" onclick="loadTutorTopic('Machine Learning')">
                            <h3 class="text-lg font-bold mb-2;">Machine Learning</h3>
                            <p style="color: var(--muted); font-size: 0.9rem;">Classification, Regression, Neural Networks, NLP</p>
                            <p style="color: var(--primary); font-size: 0.85rem; margin-top: 10px;">Click to learn →</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // ==================== PERFORMANCE & CACHING SYSTEM ====================
        const CACHE_CONFIG = {
            enabled: true,
            duration: 5 * 60 * 1000, // 5 minutes
            maxSize: 100,
            useIndexedDB: false
        };

        const dataCache = {
            store: {},
            timestamps: {},
            hits: 0,
            misses: 0,
            
            set(key, value, ttl = CACHE_CONFIG.duration) {
                if (!CACHE_CONFIG.enabled) return;
                this.store[key] = value;
                this.timestamps[key] = Date.now() + ttl;
                console.log(`📦 Cached: ${key} (${this.getSize(value)} bytes)`);
                if (Object.keys(this.store).length > CACHE_CONFIG.maxSize) {
                    this.cleanup();
                }
            },
            
            get(key) {
                if (!this.store[key]) {
                    this.misses++;
                    return null;
                }
                if (Date.now() > this.timestamps[key]) {
                    delete this.store[key];
                    delete this.timestamps[key];
                    this.misses++;
                    return null;
                }
                this.hits++;
                console.log(`✅ Cache HIT: ${key} (${this.hits} hits, ${this.misses} misses)`);
                return this.store[key];
            },
            
            getSize(obj) {
                return new Blob([JSON.stringify(obj)]).size;
            },
            
            cleanup() {
                const now = Date.now();
                let removed = 0;
                for (let key in this.timestamps) {
                    if (now > this.timestamps[key]) {
                        delete this.store[key];
                        delete this.timestamps[key];
                        removed++;
                    }
                }
                console.log(`🧹 Cache cleaned: ${removed} expired items`);
            },
            
            getStats() {
                const hitRate = this.hits + this.misses > 0 ? (this.hits / (this.hits + this.misses) * 100).toFixed(1) : 0;
                return { hits: this.hits, misses: this.misses, hitRate: hitRate + '%' };
            }
        };

        // Optimized fetch with automatic caching
        async function cachedFetch(url, options = {}) {
            const cacheKey = `FETCH_${url}`;
            const cached = dataCache.get(cacheKey);
            if (cached) return cached;
            
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 8000);
                
                const response = await fetch(url, {
                    signal: controller.signal,
                    headers: {
                        'Accept-Encoding': 'gzip, deflate',
                        'Cache-Control': 'max-age=300',
                        ...options.headers
                    }
                });
                clearTimeout(timeoutId);
                
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                const data = await response.json();
                dataCache.set(cacheKey, data);
                return data;
            } catch (error) {
                console.warn(`⚠️ Fetch failed: ${error.message}`);
                return null;
            }
        }

        // Performance monitoring
        const perfMetrics = {
            pageLoadStart: performance.now(),
            measurements: {},
            
            mark(label) {
                this.measurements[label] = performance.now() - this.pageLoadStart;
                console.log(`⏱️ ${label}: ${this.measurements[label].toFixed(0)}ms`);
            },
            
            report() {
                console.log('\n📊 PERFORMANCE REPORT:');
                for (let key in this.measurements) {
                    console.log(`  • ${key}: ${this.measurements[key].toFixed(0)}ms`);
                }
                console.log(`  📦 Cache Stats:`, dataCache.getStats());
            }
        };

        // ==================== NETWORK STATUS MONITORING ====================
        let isNetworkOnline = navigator.onLine;
        let serverStatus = { connected: false, lastCheck: null };
        let autoConnectEnabled = true;
        let connectionCheckInterval = null;

        // Auto-connect configuration
        const AUTO_CONNECT_CONFIG = {
            enabled: true,
            checkInterval: 15000, // Check every 15 seconds
            maxRetries: 5,
            retryDelay: 2000,
            autoStartChat: true, // Auto-start ChatGPT when online
            autoSyncData: true   // Auto-sync data when online
        };

        // Monitor network status changes
        window.addEventListener('online', () => {
            isNetworkOnline = true;
            console.log('✅ Network Status: ONLINE');
            showNotification('Internet connection restored - Automatic mode activated!', 'success');
            updateNetworkIndicator();
            activateAutoConnect();
        });

        window.addEventListener('offline', () => {
            isNetworkOnline = false;
            console.log('❌ Network Status: OFFLINE');
            showNotification('Internet connection lost - Offline mode activated', 'warning');
            updateNetworkIndicator();
            deactivateAutoConnect();
        });

        // Activate automatic online connection system
        async function activateAutoConnect() {
            if (!AUTO_CONNECT_CONFIG.enabled) return;
            
            console.log('🔄 Activating automatic online connection system...');
            clearInterval(connectionCheckInterval);
            
            // Check server connection immediately
            await checkServerConnection();
            
            if (serverStatus.connected) {
                console.log('✅ Auto-connect: Server connected');
                CHATGPT_CONFIG.useOnline = true;
                
                // Auto-start ChatGPT if configured
                if (AUTO_CONNECT_CONFIG.autoStartChat) {
                    console.log('🤖 Auto-enabling ChatGPT AI Tutor...');
                    showNotification('ChatGPT AI Tutor automatically enabled!', 'info');
                }
                
                // Auto-sync data if configured
                if (AUTO_CONNECT_CONFIG.autoSyncData) {
                    console.log('📊 Auto-syncing data with server...');
                    syncDataWithServer();
                }
            }
            
            // Set up periodic connection monitoring
            connectionCheckInterval = setInterval(async () => {
                await checkServerConnection();
                if (!serverStatus.connected && isNetworkOnline) {
                    console.log('⚠️ Server disconnected but internet available - Attempting reconnect...');
                    attemptReconnect();
                }
            }, AUTO_CONNECT_CONFIG.checkInterval);
        }

        // Deactivate automatic online connection system
        function deactivateAutoConnect() {
            console.log('🔌 Deactivating automatic online connection system...');
            clearInterval(connectionCheckInterval);
            CHATGPT_CONFIG.useOnline = false;
        }

        // Attempt to reconnect to server
        async function attemptReconnect(attempt = 1) {
            if (attempt > AUTO_CONNECT_CONFIG.maxRetries) {
                console.warn('❌ Max reconnection attempts reached');
                return false;
            }
            
            console.log(`🔄 Reconnection attempt ${attempt}/${AUTO_CONNECT_CONFIG.maxRetries}...`);
            
            try {
                await new Promise(resolve => setTimeout(resolve, AUTO_CONNECT_CONFIG.retryDelay * attempt));
                const response = await fetch('http://localhost:3000/api/leaderboard', {
                    method: 'GET',
                    signal: AbortSignal.timeout(3000)
                });
                
                if (response.ok) {
                    serverStatus.connected = true;
                    console.log('✅ Reconnected to server!');
                    showNotification('Reconnected to server successfully!', 'success');
                    updateNetworkIndicator();
                    return true;
                }
            } catch (error) {
                console.warn(`Reconnection attempt ${attempt} failed:`, error.message);
                if (attempt < AUTO_CONNECT_CONFIG.maxRetries) {
                    return attemptReconnect(attempt + 1);
                }
            }
            return false;
        }

        // Sync data with server
        async function syncDataWithServer() {
            try {
                console.log('📡 Syncing data with server...');
                const userData = JSON.parse(localStorage.getItem('smartmentorai_user') || '{}');
                
                if (userData && Object.keys(userData).length > 0) {
                    // Send user data to server
                    const response = await fetch('http://localhost:3000/api/leaderboard', {
                        method: 'GET',
                        signal: AbortSignal.timeout(5000)
                    });
                    
                    if (response.ok) {
                        console.log('✅ Data synced successfully');
                        showNotification('Data synchronized with server', 'success');
                    }
                }
            } catch (error) {
                console.warn('Data sync failed:', error.message);
            }
        }

        // Check server connection
        async function checkServerConnection() {
            try {
                const response = await fetch('http://localhost:3000/api/leaderboard', {
                    method: 'GET',
                    signal: AbortSignal.timeout(3000)
                });
                serverStatus.connected = response.ok;
                serverStatus.lastCheck = new Date();
                console.log('📡 Server Status:', serverStatus.connected ? 'Connected' : 'Disconnected');
                updateNetworkIndicator();
                return serverStatus.connected;
            } catch (error) {
                serverStatus.connected = false;
                serverStatus.lastCheck = new Date();
                console.warn('Server check failed:', error.message);
                updateNetworkIndicator();
                return false;
            }
        }

        // Update network indicator in UI
        function updateNetworkIndicator() {
            const indicator = document.getElementById('networkStatus');
            if (indicator) {
                if (isNetworkOnline && serverStatus.connected) {
                    indicator.innerHTML = '<span style="color: var(--success); font-weight: 600;">🟢 Online (Auto)</span>';
                    indicator.title = 'Connected to server and internet - Auto mode active';
                    indicator.style.backgroundColor = 'rgba(16, 185, 129, 0.2)';
                } else if (isNetworkOnline && !serverStatus.connected) {
                    indicator.innerHTML = '<span style="color: var(--warning); font-weight: 600;">🟡 Local Only</span>';
                    indicator.title = 'Internet available but server unreachable';
                    indicator.style.backgroundColor = 'rgba(245, 158, 11, 0.2)';
                } else {
                    indicator.innerHTML = '<span style="color: var(--error); font-weight: 600;">🔴 Offline</span>';
                    indicator.title = 'No internet connection - Offline mode active';
                    indicator.style.backgroundColor = 'rgba(239, 68, 68, 0.2)';
                }
            }
        }

        // Check on page load and periodically
        window.addEventListener('load', () => {
            perfMetrics.mark('Page Load Complete');
            console.log('🚀 SmartMentorAI Loading - Initializing network system...');
            checkServerConnection().then(connected => {
                if (isNetworkOnline && connected) {
                    activateAutoConnect();
                }
            });
            updateNetworkIndicator();
            
            // Show performance report after 2 seconds
            setTimeout(() => perfMetrics.report(), 2000);
        });

        // Optional: Toggle auto-connect manually
        function toggleAutoConnect() {
            AUTO_CONNECT_CONFIG.enabled = !AUTO_CONNECT_CONFIG.enabled;
            console.log('Auto-connect:', AUTO_CONNECT_CONFIG.enabled ? 'Enabled' : 'Disabled');
            if (AUTO_CONNECT_CONFIG.enabled && isNetworkOnline) {
                activateAutoConnect();
            } else {
                deactivateAutoConnect();
            }
            showNotification(`Auto-connect ${AUTO_CONNECT_CONFIG.enabled ? 'enabled' : 'disabled'}`, 'info');
        }

        // ==================== ORIGINAL CODE BELOW ====================
        // Configuration
        const API_URL = 'http://localhost:4000';
        
        // State
        let currentUser = JSON.parse(localStorage.getItem('smartmentorai_user') || 'null');
        let currentToken = null;
        let assessmentData = { interests: [], skills: {}, goal: '' };
        let courses = [];
        let currentStep = 1;

        // UI Functions
        function showModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
        }

        function showAlert(message, type = 'success') {
            const alertId = type === 'success' ? 'successAlert' : 'errorAlert';
            const alert = document.getElementById(alertId);
            alert.textContent = message;
            alert.classList.add('show');
            setTimeout(() => alert.classList.remove('show'), 3000);
        }

        function switchSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
        }

        function switchDashboard(viewId) {
            document.querySelectorAll('.dashboard-view').forEach(v => v.style.display = 'none');
            document.getElementById(viewId).style.display = 'block';
            
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            event.target.classList.add('active');
        }

        // Auth Functions
        function register() {
            const username = document.getElementById('authUsername').value.trim();
            const password = document.getElementById('authPassword').value.trim();
            
            if (!username || !password) {
                showAlert('Please fill all fields', 'error');
                return;
            }

            let users = JSON.parse(localStorage.getItem('smartmentorai_users') || '{}');
            
            if (users[username]) {
                showAlert('Username already exists', 'error');
                return;
            }

            users[username] = { password, points: 0, badges: [] };
            localStorage.setItem('smartmentorai_users', JSON.stringify(users));
            
            currentUser = { name: username, points: 0, badges: [], id: Date.now() };
            localStorage.setItem('smartmentorai_user', JSON.stringify(currentUser));
            closeModal('authModal');
            document.getElementById('authUsername').value = '';
            document.getElementById('authPassword').value = '';
            initDashboard();
            showAlert('Registration successful!');
        }

        function login() {
            const username = document.getElementById('authUsername').value.trim();
            const password = document.getElementById('authPassword').value.trim();
            
            if (!username || !password) {
                showAlert('Please fill all fields', 'error');
                return;
            }

            let users = JSON.parse(localStorage.getItem('smartmentorai_users') || '{}');
            
            if (!users[username]) {
                showAlert('User not found. Please register first.', 'error');
                return;
            }
            
            if (users[username].password !== password) {
                showAlert('Incorrect password', 'error');
                return;
            }

            currentUser = { name: username, points: users[username].points || 0, badges: users[username].badges || [], id: Date.now() };
            localStorage.setItem('smartmentorai_user', JSON.stringify(currentUser));
            closeModal('authModal');
            document.getElementById('authUsername').value = '';
            document.getElementById('authPassword').value = '';
            initDashboard();
            showAlert('Login successful!');
        }

        function logout() {
            currentUser = null;
            currentToken = null;
            localStorage.removeItem('smartmentorai_user');
            switchSection('welcome');
            showAlert('Logged out successfully');
        }

        // Assessment Functions
        function startAssessment() {
            if (!currentUser) {
                showModal('authModal');
                return;
            }
            showModal('assessmentModal');
        }

        function selectInterest(element, interest) {
            element.classList.toggle('selected');
            if (element.classList.contains('selected')) {
                if (!assessmentData.interests.includes(interest)) {
                    assessmentData.interests.push(interest);
                }
            } else {
                assessmentData.interests = assessmentData.interests.filter(i => i !== interest);
            }
        }

        function nextAssessmentStep() {
            if (currentStep === 1) {
                if (assessmentData.interests.length === 0) {
                    showAlert('Please select at least one interest', 'error');
                    return;
                }
                currentStep = 2;
                document.getElementById('assessmentStep1').style.display = 'none';
                document.getElementById('assessmentStep2').style.display = 'block';
                document.getElementById('step2').classList.remove('completed');
                document.getElementById('step2').classList.add('active');
            } else if (currentStep === 2) {
                currentStep = 3;
                document.getElementById('assessmentStep2').style.display = 'none';
                document.getElementById('assessmentStep3').style.display = 'block';
                document.getElementById('step3').classList.remove('completed');
                document.getElementById('step3').classList.add('active');
            }
        }

        function prevAssessmentStep() {
            if (currentStep === 3) {
                currentStep = 2;
                document.getElementById('assessmentStep3').style.display = 'none';
                document.getElementById('assessmentStep2').style.display = 'block';
                document.getElementById('step3').classList.remove('active');
                document.getElementById('step3').classList.add('completed');
            } else if (currentStep === 2) {
                currentStep = 1;
                document.getElementById('assessmentStep2').style.display = 'none';
                document.getElementById('assessmentStep1').style.display = 'block';
                document.getElementById('step2').classList.remove('active');
                document.getElementById('step2').classList.add('completed');
            }
        }

        function completeAssessment() {
            // Show processing animation
            const step3 = document.getElementById('assessmentStep3');
            const originalContent = step3.innerHTML;
            step3.innerHTML = '<div style="text-align: center;"><div class="gears-animation">⚙️</div><p style="color: var(--muted); margin-top: 20px;">Analyzing your profile and generating your personalized learning path...</p></div>';
            
            // Simulate processing
            setTimeout(() => {
                step3.innerHTML = originalContent;
                currentUser.points = (currentUser.points || 0) + 25;
                currentUser.badges = (currentUser.badges || []);
                if (!currentUser.badges.includes('Path Creator')) {
                    currentUser.badges.push('Path Creator');
                }
                localStorage.setItem('user', JSON.stringify(currentUser));
                closeModal('assessmentModal');
                initDashboard();
                showAlert('Assessment complete! +25 points earned!');
            }, 3000);
        }

        // Dashboard Initialization with Performance Optimization
        function initDashboard() {
            perfMetrics.mark('Dashboard Init Start');
            switchSection('dashboard');
            if (!currentUser) return;
            
            document.getElementById('dashboardUsername').textContent = currentUser.name;
            document.getElementById('portfolioUsername').textContent = currentUser.name;
            document.getElementById('statPoints').textContent = currentUser.points || 0;
            document.getElementById('statBadges').textContent = (currentUser.badges || []).length;
            document.getElementById('statStreak').textContent = Math.floor(Math.random() * 10) + 1;
            
            // Load courses with demo data (cached)
            loadCourses();
            
            // Initialize interview and AI tutor views
            initializeInterviewView();
            initializeAITutorView();
            
            // Initialize session tracking and offline indicators
            initializeSessionTracking();
            
            // Initialize all charts with lazy loading
            requestAnimationFrame(() => {
                initSkillChart();
                initLearningChart();
                initActivityChart();
                initCourseProgressChart();
                updateAnalyticsDashboard();
                startRealTimeUpdates();
                perfMetrics.mark('Dashboard Init Complete');
            });
        }

        // Initialize Interview View
        function initializeInterviewView() {
            // Ensure all interview elements exist
            const webcamEl = document.getElementById('webcam');
            const placeholderEl = document.getElementById('cameraPlaceholder');
            const timerEl = document.getElementById('timer');
            const feedbackEl = document.getElementById('feedbackCard');
            
            if (!webcamEl || !placeholderEl || !timerEl || !feedbackEl) {
                console.warn('Some interview elements are missing');
                return;
            }
            
            // Set initial state
            timerEl.textContent = '5:00';
            timerEl.style.color = 'var(--primary)';
            if (feedbackEl) feedbackEl.style.display = 'none';
            
            console.log('[OK] Interview view initialized');
        }

        // Initialize AI Tutor View
        function initializeAITutorView() {
            // Ensure all AI tutor elements exist
            const problemInput = document.getElementById('tutorProblem');
            const responseBox = document.getElementById('tutorResponseBox');
            const responseText = document.getElementById('tutorResponse');
            const codeSnippet = document.getElementById('codeSnippet');
            
            if (!problemInput || !responseBox || !responseText || !codeSnippet) {
                console.warn('Some AI tutor elements are missing');
                return;
            }
            
            // Set initial state
            problemInput.value = '';
            responseBox.style.display = 'none';
            
            // Update ChatGPT setup notice visibility
            updateChatGPTSetupNotice();
            
            console.log('[OK] AI tutor view initialized');
        }

        function loadCourses() {
            perfMetrics.mark('Load Courses Start');
            
            // Check cache first
            const cached = dataCache.get('COURSES_DATA');
            if (cached) {
                courses = cached;
                displayCourses();
                perfMetrics.mark('Load Courses Complete (Cached)');
                return;
            }
            
            // Load demo courses
            courses = [
                { title: 'Python Basics', modules: ['Intro', 'Variables', 'Functions', 'OOP', 'Modules'] },
                { title: 'Data Science 101', modules: ['Numpy', 'Pandas', 'Matplotlib', 'Statistics'] },
                { title: 'Web Development', modules: ['HTML5', 'CSS3', 'JavaScript', 'React', 'Node.js'] },
                { title: 'Cloud Computing', modules: ['AWS Basics', 'Cloud Architecture', 'Deployment', 'DevOps'] },
                { title: 'Machine Learning', modules: ['Supervised Learning', 'Unsupervised', 'Deep Learning'] }
            ];
            
            // Cache for next time
            dataCache.set('COURSES_DATA', courses, 10 * 60 * 1000); // Cache for 10 minutes
            displayCourses();
            perfMetrics.mark('Load Courses Complete');
        }

        function displayCourses() {
            const coursesList = document.getElementById('coursesList');
            coursesList.innerHTML = courses.map(c => `
                <div class="course-card">
                    <h3 class="text-lg font-bold mb-2">${c.title}</h3>
                    <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 15px;">${c.modules?.length || 0} modules</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.random() * 50 + 20}%;"></div>
                    </div>
                    <button class="btn-secondary" style="width: 100%; margin-top: 15px;" onclick="continueLearning('${c.title}')">Continue Learning →</button>
                </div>
            `).join('');
        }

        function viewCourse(slug) {
            showAlert('Loading course content...');
        }

        // Analytics data
        let analyticsData = {
            labsCompleted: 3,
            projectsCompleted: 5,
            interviewScore: 75,
            learningHours: 45,
            skillProgress: { Python: 85, DataAnalysis: 72, Cloud: 50, ML: 65, WebDev: 55 },
            dailyActivity: [12, 18, 25, 15, 30, 28, 35],
            courseProgress: { 'Python Basics': 85, 'Data Science': 60, 'Web Dev': 45, 'Cloud Computing': 30 },
            weeklyProgress: [60, 65, 72, 68, 75, 80, 85]
        };

        function initSkillChart() {
            const ctx = document.getElementById('skillChart');
            if (ctx && window.Chart) {
                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Python', 'Data Analysis', 'Cloud', 'ML', 'Web Dev'],
                        datasets: [{
                            data: [85, 72, 50, 65, 55],
                            backgroundColor: [
                                'rgba(14, 165, 164, 0.8)',
                                'rgba(6, 182, 212, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(14, 165, 164, 0.5)',
                                'rgba(6, 182, 212, 0.5)'
                            ],
                            borderColor: 'rgba(255, 255, 255, 0.1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                labels: { color: '#e6eef6', padding: 20, font: { size: 12, weight: 'bold' } }
                            }
                        }
                    }
                });
            }
        }

        function initLearningChart() {
            const ctx = document.getElementById('learningChart');
            if (ctx && window.Chart) {
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Learning Hours',
                            data: analyticsData.weeklyProgress,
                            borderColor: 'rgba(14, 165, 164, 1)',
                            backgroundColor: 'rgba(14, 165, 164, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: 'rgba(14, 165, 164, 1)',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6,
                            pointHoverRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { labels: { color: '#e6eef6' } }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(14, 165, 164, 0.1)' },
                                ticks: { color: '#a0aec0' }
                            },
                            x: {
                                grid: { color: 'rgba(14, 165, 164, 0.1)' },
                                ticks: { color: '#a0aec0' }
                            }
                        }
                    }
                });
            }
        }

        function initActivityChart() {
            const ctx = document.getElementById('activityChart');
            if (ctx && window.Chart) {
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Daily Activity (minutes)',
                            data: analyticsData.dailyActivity,
                            backgroundColor: [
                                'rgba(14, 165, 164, 0.8)',
                                'rgba(6, 182, 212, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(14, 165, 164, 0.8)',
                                'rgba(6, 182, 212, 0.8)',
                                'rgba(139, 92, 246, 0.8)'
                            ],
                            borderRadius: 8,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { labels: { color: '#e6eef6' } }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(14, 165, 164, 0.1)' },
                                ticks: { color: '#a0aec0' }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { color: '#a0aec0' }
                            }
                        }
                    }
                });
            }
        }

        function initCourseProgressChart() {
            const ctx = document.getElementById('courseProgressChart');
            if (ctx && window.Chart) {
                const courses = Object.keys(analyticsData.courseProgress);
                const progress = Object.values(analyticsData.courseProgress);
                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: courses,
                        datasets: [{
                            label: 'Course Completion %',
                            data: progress,
                            backgroundColor: 'rgba(14, 165, 164, 0.8)',
                            borderColor: 'rgba(14, 165, 164, 1)',
                            borderWidth: 2,
                            borderRadius: 8,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: { labels: { color: '#e6eef6' } }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(14, 165, 164, 0.1)' },
                                ticks: { color: '#a0aec0' }
                            },
                            y: {
                                grid: { display: false },
                                ticks: { color: '#a0aec0' }
                            }
                        }
                    }
                });
            }
        }

        // Lab Functions
        function runLabCode() {
            const code = document.getElementById('labCode').value;
            const output = document.getElementById('labOutput');
            
            if (!code.trim()) {
                output.innerHTML = '[ERROR] Error: Please write some code first!';
                return;
            }
            
            output.innerHTML = '⏳ Executing code...\n\n';
            
            setTimeout(() => {
                output.innerHTML = `[OK] Code executed successfully!

Console Output:
─────────────────────────────────
Loading data from CSV...
Data shape: (506, 13)
Features: CRIM, ZN, INDUS, CHAS, NOX, RM, AGE, DIS, RAD, TAX, PTRATIO, B, LSTAT

Training linear regression model...
✓ Model trained in 0.45s

Evaluation Results:
─────────────────────────────────
R² Score: 0.7438
Mean Absolute Error: 4.79
Root Mean Squared Error: 6.07
Cross-validation Score: 0.72 ± 0.08

Sample Predictions:
─────────────────────────────────
Actual Price: \$24.0K → Predicted: \$24.5K
Actual Price: \$21.6K → Predicted: \$20.8K
Actual Price: \$34.7K → Predicted: \$35.2K

✓ Lab execution complete!`;
            }, 1500);
        }

        function submitLab() {
            const code = document.getElementById('labCode').value;
            
            if (!code.trim()) {
                showAlert('Please write and run some code first!', 'error');
                return;
            }
            
            currentUser.points = (currentUser.points || 0) + 50;
            currentUser.badges = currentUser.badges || [];
            if (!currentUser.badges.includes('Lab Master')) {
                currentUser.badges.push('Lab Master');
            }
            currentUser.completedLabs = (currentUser.completedLabs || 0) + 1;
            localStorage.setItem('user', JSON.stringify(currentUser));
            
            showAlert('Lab submitted successfully! +50 points & Lab Master badge earned! 🎉');
            document.getElementById('labCode').value = '';
            document.getElementById('labOutput').innerHTML = 'Console output will appear here...';
            initDashboard();
        }

        // Community Functions
        function viewCommunity() {
            showAlert(`Community Features Coming Soon:\n\n✓ Discussion forums\n✓ Study groups\n✓ Peer code reviews\n✓ Knowledge sharing\n✓ Networking events\n\nStay tuned for community features!`);
        }

        function viewCommunityForum(forumName) {
            showAlert(`Opening ${forumName} forum...\n\nForum features coming soon!`);
        }

        function submitFeedback() {
            const feedbackType = document.getElementById('feedbackType').value;
            const feedbackEmail = document.getElementById('feedbackEmail').value;
            const feedbackText = document.getElementById('feedbackText').value;

            // Validation
            if (!feedbackType) {
                showNotification('Please select a feedback type', 'error');
                return;
            }

            if (!feedbackEmail) {
                showNotification('Please enter your email address', 'error');
                return;
            }

            if (!feedbackEmail.includes('@')) {
                showNotification('Please enter a valid email address', 'error');
                return;
            }

            if (!feedbackText || feedbackText.trim().length < 10) {
                showNotification('Please enter detailed feedback (at least 10 characters)', 'error');
                return;
            }

            // Simulate sending feedback
            const feedbackData = {
                type: feedbackType,
                email: feedbackEmail,
                message: feedbackText,
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent
            };

            console.log('Feedback submitted:', feedbackData);

            // Show success message
            showNotification('✉️ Thank you for your feedback! We appreciate your input.', 'success');

            // Clear the form
            clearFeedbackForm();

            // Log to local storage for demo purposes
            let feedbackHistory = JSON.parse(localStorage.getItem('smartMentorAIFeedback') || '[]');
            feedbackHistory.push(feedbackData);
            localStorage.setItem('smartMentorAIFeedback', JSON.stringify(feedbackHistory));
        }

        function clearFeedbackForm() {
            document.getElementById('feedbackType').value = '';
            document.getElementById('feedbackEmail').value = '';
            document.getElementById('feedbackText').value = '';
        }

        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 8px;
                font-weight: 600;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
                max-width: 400px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            `;

            if (type === 'success') {
                notification.style.background = 'rgba(20, 184, 166, 0.9)';
                notification.style.color = 'white';
            } else if (type === 'error') {
                notification.style.background = 'rgba(239, 68, 68, 0.9)';
                notification.style.color = 'white';
            } else {
                notification.style.background = 'rgba(59, 130, 246, 0.9)';
                notification.style.color = 'white';
            }

            notification.textContent = message;
            document.body.appendChild(notification);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // ==================== COURSE & LEARNING PATH FUNCTIONS ====================
        const coursesData = [
            {
                id: 1,
                name: 'Python for Data Science',
                instructor: 'Dr. Sarah Chen',
                progress: 65,
                rating: 4.8,
                students: 2450,
                hours: 32,
                modules: 8,
                currentLesson: 'Advanced Pandas & NumPy',
                status: 'in-progress'
            },
            {
                id: 2,
                name: 'Machine Learning Fundamentals',
                instructor: 'Prof. James Wilson',
                progress: 45,
                rating: 4.7,
                students: 1890,
                hours: 40,
                modules: 10,
                currentLesson: 'Supervised Learning Algorithms',
                status: 'in-progress'
            },
            {
                id: 3,
                name: 'Deep Learning with TensorFlow',
                instructor: 'Dr. Yuki Tanaka',
                progress: 0,
                rating: 4.9,
                students: 1230,
                hours: 48,
                modules: 12,
                currentLesson: 'Getting Started',
                status: 'not-started'
            },
            {
                id: 4,
                name: 'Web Development with React',
                instructor: 'Alex Martinez',
                progress: 30,
                rating: 4.6,
                students: 3200,
                hours: 35,
                modules: 9,
                currentLesson: 'State Management with Redux',
                status: 'in-progress'
            }
        ];

        function initializeCourses() {
            const coursesList = document.getElementById('coursesList');
            if (!coursesList) return;

            coursesList.innerHTML = coursesData.map(course => `
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                        <h3 class="text-lg font-bold">${course.name}</h3>
                        <span style="background: ${course.progress === 0 ? 'rgba(14, 165, 164, 0.2)' : course.progress === 100 ? 'rgba(16, 185, 129, 0.2)' : 'rgba(59, 130, 246, 0.2)'}; 
                                   color: ${course.progress === 0 ? '#0ea5a4' : course.progress === 100 ? '#10b981' : '#3b82f6'};
                                   padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">
                            ${course.progress === 0 ? 'New' : course.progress === 100 ? 'Completed' : 'In Progress'}
                        </span>
                    </div>
                    <p style="color: var(--muted); font-size: 0.9rem; margin-bottom: 8px;">By ${course.instructor}</p>
                    <div style="display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;">
                        <span style="color: var(--primary); font-size: 0.8rem;">⭐ ${course.rating}</span>
                        <span style="color: var(--muted); font-size: 0.8rem;">${course.students}</span>
                        <span style="color: var(--muted); font-size: 0.8rem;">⏱ ${course.hours}h</span>
                    </div>
                    <div style="background: rgba(14, 165, 164, 0.1); padding: 8px; border-radius: 6px; margin-bottom: 12px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                            <span style="color: var(--muted); font-size: 0.85rem;">Progress</span>
                            <span style="color: var(--primary); font-weight: 600;">${course.progress}%</span>
                        </div>
                        <div class="progress-bar" style="height: 6px;">
                            <div class="progress-fill" style="width: ${course.progress}%; background: linear-gradient(90deg, #0ea5a4, #06b6d4);"></div>
                        </div>
                    </div>
                    <p style="color: var(--muted); font-size: 0.85rem; margin-bottom: 12px;">Lesson: ${course.currentLesson}</p>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-primary" style="flex: 1; font-size: 0.9rem;" onclick="continueCourse('${course.name}', ${course.id})">
                            ${course.progress === 0 ? '▶ Start Course' : course.progress === 100 ? '✓ Review' : '▶ Continue'}
                        </button>
                        <button class="btn-secondary" style="flex: 1; font-size: 0.9rem;" onclick="viewCourseDetails(${course.id})">Details</button>
                    </div>
                </div>
            `).join('');
        }

        function continueCourse(courseName, courseId) {
            const course = coursesData.find(c => c.id === courseId);
            if (course.progress === 0) {
                // Enroll in course
                course.status = 'in-progress';
                course.progress = 15;
                initializeCourses();
                showNotification(`✓ Enrolled in "${courseName}"! Starting first lesson...`, 'success');
            } else if (course.progress === 100) {
                showNotification(`✓ Great! You completed "${courseName}". Consider starting a related course!`, 'success');
            } else {
                showNotification(`▶ Resuming "${courseName}" from lesson: ${course.currentLesson}`, 'info');
                // Update progress
                if (course.progress < 100) {
                    course.progress = Math.min(100, course.progress + 5);
                    initializeCourses();
                }
            }
        }

        function viewCourseDetails(courseId) {
            const course = coursesData.find(c => c.id === courseId);
            showAlert(`${course.name}\n\nInstructor: ${course.instructor}\nRating: ⭐ ${course.rating}/5.0\nStudents: ${course.students}\nDuration: ${course.hours} hours\nModules: ${course.modules}\nCurrent Lesson: ${course.currentLesson}\n\nClick OK to start learning!`);
        }

        // ==================== PROJECTS FUNCTIONS ====================
        const projectsData = {
            inProgress: [
                {
                    id: 1,
                    name: 'IoT Smart Home Prototype',
                    status: 'Pending Mentor Review',
                    deadline: 'July 20, 2025',
                    progress: 85,
                    description: 'Building a smart home automation system using IoT sensors and cloud connectivity'
                },
                {
                    id: 2,
                    name: 'Customer Churn Prediction',
                    company: 'TechCorp Inc.',
                    status: 'Data Cleaning Phase',
                    deadline: 'August 5, 2025',
                    progress: 60,
                    description: 'ML model to predict customer churn and identify retention strategies'
                }
            ],
            completed: [
                {
                    id: 3,
                    name: 'Image Classification with CNNs',
                    tags: ['#DeepLearning', '#Python', '#ComputerVision'],
                    rating: 4.8,
                    description: 'Developed a CNN model for image classification achieving 94% accuracy',
                    addedToPortfolio: false
                },
                {
                    id: 4,
                    name: 'Real-time Chat Application',
                    tags: ['#WebDev', '#React', '#Firebase'],
                    rating: 4.7,
                    description: 'Built a real-time messaging app with React and Firebase backend',
                    addedToPortfolio: true
                },
                {
                    id: 5,
                    name: 'Stock Price Prediction API',
                    tags: ['#API', '#Python', '#DataScience'],
                    rating: 4.9,
                    description: 'RESTful API for stock price prediction using LSTM neural networks',
                    addedToPortfolio: true
                }
            ]
        };

        function goToProjectWorkspace(projectName) {
            const project = projectsData.inProgress.find(p => p.name === projectName);
            if (project) {
                showNotification(`Opening workspace for "${projectName}"...`, 'info');
                showAlert(`Project Workspace: ${projectName}\n\nStatus: ${project.status}\nProgress: ${project.progress}%\nDeadline: ${project.deadline}\n\nFeatures:\n- Code Editor\n- Mentor Chat\n- Submission Portal\n- Version Control\n\nWorkspace features coming soon!`);
            }
        }

        function continueProject(projectName) {
            const project = projectsData.inProgress.find(p => p.name === projectName);
            if (project) {
                if (project.progress < 100) {
                    project.progress = Math.min(100, project.progress + 10);
                }
                showNotification(`✓ Resuming: ${projectName} (${project.progress}% complete)`, 'success');
            }
        }

        function addToPortfolio(projectName) {
            const project = projectsData.completed.find(p => p.name === projectName);
            if (project && !project.addedToPortfolio) {
                project.addedToPortfolio = true;
                showNotification(`✓ Added "${projectName}" to your portfolio!`, 'success');
            } else if (project && project.addedToPortfolio) {
                showNotification(`ℹ "${projectName}" is already in your portfolio`, 'info');
            }
        }

        function viewProjectFeedback(projectName) {
            const project = projectsData.completed.find(p => p.name === projectName);
            if (project) {
                showAlert(`Mentor Feedback: ${projectName}\n\nRating: ⭐ ${project.rating}/5.0\n\nFeedback:\n✓ Excellent code structure\n✓ Great documentation\n✓ Creative approach\n\nSuggestions:\n- Consider adding more error handling\n- Optimize the model training loop\n\nKeep up the great work!`);
            }
        }

        function viewProjectCode(projectName) {
            const project = projectsData.completed.find(p => p.name === projectName);
            if (project) {
                showAlert(`Project Code: ${projectName}\n\n${project.description}\n\nGitHub Repository:\nhttps://github.com/yourprofile/${projectName.toLowerCase().replace(/\s+/g, '-')}\n\nTechnologies:\n${project.tags.join(', ')}\n\nCode view and management tools coming soon!`);
            }
        }

        // ==================== CAREER ZONE FUNCTIONS ====================
        const jobsData = [
            {
                id: 1,
                title: 'Data Scientist - Entry Level',
                company: 'Analytics Solutions',
                location: 'Hyderabad',
                salary: '6-8 LPA',
                skillsMatch: 85,
                applied: false,
                description: 'We are looking for a data scientist to analyze business metrics and drive data-informed decisions.'
            },
            {
                id: 2,
                title: 'ML Engineer',
                company: 'Tech Innovations',
                location: 'Bangalore',
                salary: '10-14 LPA',
                skillsMatch: 72,
                applied: false,
                description: 'Build and deploy machine learning models for real-world applications. Work with cutting-edge AI technologies.'
            },
            {
                id: 3,
                title: 'Python Developer',
                company: 'Web Systems Ltd',
                location: 'Remote',
                salary: '7-10 LPA',
                skillsMatch: 78,
                applied: false,
                description: 'Develop scalable Python applications using Django and FastAPI frameworks.'
            }
        ];

        function applyForJob(jobTitle) {
            const job = jobsData.find(j => j.title === jobTitle);
            if (job && !job.applied) {
                job.applied = true;
                // Update application count
                const appCount = document.getElementById('jobApplications');
                if (appCount) {
                    appCount.textContent = parseInt(appCount.textContent) + 1;
                }
                showNotification(`✉️ Application submitted for "${jobTitle}"!`, 'success');
                showAlert(`Application Submitted!\n\nPosition: ${job.title}\nCompany: ${job.company}\n\nWhat's Next:\n1. We'll review your profile\n2. You'll receive email updates\n3. Interviews scheduled within 3-5 days\n\nGood Luck! 🚀`);
            } else if (job && job.applied) {
                showNotification(`ℹ You've already applied for this position`, 'info');
            }
        }

        function showJobDetails(jobId) {
            const job = jobsData.find(j => j.id === jobId);
            if (job) {
                showAlert(`Job Details\n\nPosition: ${job.title}\nCompany: ${job.company}\nLocation: ${job.location}\nSalary: ${job.salary}\nSkills Match: ${job.skillsMatch}%\n\n${job.description}`);
            }
        }

        function editPortfolio() {
            showNotification(`Opening portfolio editor...`, 'info');
            showAlert(`Portfolio Editor\n\nYou can:\n- Add/remove projects\n- Edit descriptions\n- Manage skills\n- Upload media\n- Customize URL\n\nPortfolio editing tools coming soon!`);
        }

        function sharePortfolioLink() {
            const username = document.getElementById('portfolioUsername')?.textContent || 'user123';
            const link = `https://smartmentorai.io/user/${username}`;
            showNotification(`Portfolio link copied to clipboard!`, 'success');
            // Copy to clipboard (simulated)
            navigator.clipboard.writeText(link).catch(() => {
                showAlert(`Share your portfolio:\n\n${link}`);
            });
        }

        function viewCommonQuestions() {
            showAlert(`Common Interview Questions\n\nTechnical:\n1. Explain overfitting and how to prevent it\n2. What's the difference between supervised and unsupervised learning?\n3. How do you handle missing data?\n\nBehavioral:\n1. Tell me about a challenging project\n2. How do you work in a team?\n3. Your greatest professional achievement\n\nClick on questions to see detailed answers and tips!`);
        }

        // ==================== INTERVIEW WEBCAM & RECORDING ====================
        let mediaStream = null;
        let mediaRecorder = null;
        let recordedChunks = [];
        let interviewTimer = null;
        let offlineMode = false;
        
        // ==================== SESSION & PERSISTENCE ====================
        let sessionHistory = [];
        let currentSession = null;
        const SESSION_STORAGE_KEY = 'smartMentorAIProSessions';
        const OFFLINE_INDICATORS_KEY = 'offlineStatus';
        
        // Load session history from localStorage
        function loadSessionHistory() {
            try {
                const stored = localStorage.getItem(SESSION_STORAGE_KEY);
                sessionHistory = stored ? JSON.parse(stored) : [];
                console.log('✅ Session history loaded:', sessionHistory.length, 'sessions');
            } catch (error) {
                console.error('Error loading session history:', error);
                sessionHistory = [];
            }
        }
        
        // Save current session
        function saveSession(sessionData) {
            try {
                currentSession = {
                    id: Date.now(),
                    timestamp: new Date().toISOString(),
                    mode: offlineMode ? 'offline' : 'online',
                    ...sessionData
                };
                sessionHistory.unshift(currentSession); // Add to beginning
                localStorage.setItem(SESSION_STORAGE_KEY, JSON.stringify(sessionHistory));
                console.log('✅ Session saved:', currentSession.id);
            } catch (error) {
                console.error('Error saving session:', error);
            }
        }
        
        // Get offline status indicator
        function getOfflineStatus() {
            return {
                isOffline: offlineMode || !navigator.onLine,
                hasCamera: mediaStream !== null,
                timestamp: new Date().toLocaleTimeString(),
                source: offlineMode ? 'Manual' : (!navigator.onLine ? 'Network' : 'Online')
            };
        }
        
        // Show offline status in UI
        function updateOfflineIndicator() {
            const status = getOfflineStatus();
            const indicator = document.getElementById('offlineIndicator');
            
            if (indicator) {
                if (status.isOffline) {
                    indicator.style.display = 'block';
                    indicator.innerHTML = `
                        <div style="background: rgba(249, 158, 11, 0.1); padding: 10px 15px; border-radius: 6px; 
                                    border-left: 3px solid var(--warning); display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.2rem;">⚠️</span>
                            <span style="color: var(--warning); font-size: 0.85rem;">
                                <strong>Offline Mode:</strong> ${status.source} | Camera: ${status.hasCamera ? '✅' : '❌'}
                            </span>
                        </div>
                    `;
                } else {
                    indicator.style.display = 'none';
                }
            }
        }
        
        // Initialize session tracking on page load
        function initializeSessionTracking() {
            loadSessionHistory();
            updateOfflineIndicator();
            
            // Listen for online/offline changes
            window.addEventListener('online', () => {
                console.log('✅ Application online detected');
                updateOfflineIndicator();
                showNotification('Connection restored', 'success');
            });
            
            window.addEventListener('offline', () => {
                console.log('⚠️ Application offline detected');
                updateOfflineIndicator();
                showNotification('Operating in offline mode', 'warning');
            });
        }

        // Offline Interview Mode - Works without camera
        function startOfflineInterview(cameraError) {
            offlineMode = true;
            const video = document.getElementById('webcam');
            const placeholder = document.getElementById('cameraPlaceholder');
            const startBtn = document.querySelector('button[onclick="startInterview()"]');
            const stopBtn = document.getElementById('stopInterview');
            
            // Hide video, show message
            if (video) {
                video.style.display = 'none';
            }
            if (placeholder) {
                placeholder.innerHTML = 'OFFLINE PRACTICE MODE<br><small>Interview recording disabled, but you can still practice</small>';
                placeholder.style.display = 'block';
                placeholder.style.background = 'rgba(139, 92, 246, 0.1)';
                placeholder.style.padding = '20px';
            }
            
            // Update buttons
            if (startBtn) startBtn.style.display = 'none';
            if (stopBtn) stopBtn.style.display = 'block';
            
            showNotification('Offline Practice Mode Enabled', 'info');
            console.log('✅ Started offline interview practice mode');
            
            // Start timer
            startInterviewTimer();
            
            // Show message
            showAlert(`OFFLINE PRACTICE MODE\\n\\nCamera is not available, but don't worry!\\n\\nYou can still:\\n✓ Answer interview questions\\n✓ Practice your responses\\n✓ Get real-time feedback\\n✓ Build your interview skills\\n\\nWhen ready, enable camera and try again!`);
        }

        async function startInterview() {
            try {
                const video = document.getElementById('webcam');
                const placeholder = document.getElementById('cameraPlaceholder');
                const startBtn = document.querySelector('button[onclick="startInterview()"]');
                const stopBtn = document.getElementById('stopInterview');
                
                if (!video || !placeholder) {
                    showNotification('❌ Interview elements not found. Please refresh the page.', 'error');
                    console.error('Missing interview elements:', { video, placeholder });
                    return;
                }
                
                showNotification('Requesting camera access...', 'info');
                
                try {
                    // Request camera access
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: { 
                            width: { ideal: 1280 },
                            height: { ideal: 720 },
                            facingMode: 'user'
                        },
                        audio: { 
                            echoCancellation: true,
                            noiseSuppression: true,
                            autoGainControl: true
                        }
                    });
                    
                    mediaStream = stream;
                    video.srcObject = stream;
                    // Ensure video is fully visible
                    video.style.display = 'block';
                    video.style.visibility = 'visible';
                    video.style.opacity = '1';
                    if (placeholder) placeholder.style.display = 'none';
                    
                    // Setup media recorder
                    recordedChunks = [];
                    const options = { 
                        mimeType: 'video/webm;codecs=vp9',
                        videoBitsPerSecond: 2500000 
                    };
                    
                    // Fallback if vp9 is not supported
                    if (!MediaRecorder.isTypeSupported(options.mimeType)) {
                        options.mimeType = 'video/webm';
                    }
                    
                    mediaRecorder = new MediaRecorder(stream, options);
                    
                    mediaRecorder.ondataavailable = (event) => {
                        if (event.data.size > 0) {
                            recordedChunks.push(event.data);
                        }
                    };
                    
                    mediaRecorder.onstop = () => {
                        const blob = new Blob(recordedChunks, { type: 'video/webm' });
                        console.log('Interview recorded:', blob.size, 'bytes');
                    };
                    
                    mediaRecorder.start();
                    
                    // Update UI
                    if (startBtn) startBtn.style.display = 'none';
                    if (stopBtn) stopBtn.style.display = 'block';
                    
                    showNotification('✅ Camera started! Interview recording...', 'success');
                    console.log('✅ Camera stream started successfully');
                    
                    // Start interview timer (5 minutes)
                    startInterviewTimer();
                    
                    // Show tips
                    showAlert(`Interview Started!\n\nTips for Success:\n✓ Speak clearly and confidently\n✓ Maintain eye contact with camera\n✓ Take your time to think\n✓ Use examples to explain\n✓ Listen carefully to questions\n\nYour session will be recorded. Good luck!`);
                    
                } catch (cameraError) {
                    // Camera failed, offer offline practice mode
                    console.warn('Camera access failed, starting offline practice mode:', cameraError);
                    let errorMsg = 'Could not access camera';
                    
                    if (cameraError.name === 'NotAllowedError') {
                        errorMsg = 'Camera access was denied. Please enable camera permissions in browser settings.';
                    } else if (cameraError.name === 'NotFoundError') {
                        errorMsg = 'No camera device found. Please check your hardware.';
                    } else if (cameraError.name === 'NotReadableError') {
                        errorMsg = 'Camera is in use by another application. Please close it first.';
                    } else if (cameraError.name === 'SecurityError') {
                        errorMsg = 'Camera access is only allowed over HTTPS or localhost.';
                    }
                    
                    console.error('Camera access error:', cameraError);
                    showNotification(`⚠️ Camera unavailable - Starting offline practice mode`, 'warning');
                    showAlert(`Camera Access Issue\n\n${errorMsg}\n\nOffline Mode Active:\nDon't worry! We're starting interview practice in offline mode.\nYou can still:\n✓ Practice answering questions\n✓ Get real-time feedback\n✓ Build your interview confidence\n\nWhen ready, enable camera and try again!`);
                    startOfflineInterview(cameraError);
                }
            } catch (error) {
                console.error('Interview startup error:', error);
                showNotification('❌ Error starting interview', 'error');
            }
        }

        function stopInterview() {
            try {
                const video = document.getElementById('webcam');
                const placeholder = document.getElementById('cameraPlaceholder');
                const startBtn = document.querySelector('button[onclick="startInterview()"]');
                const stopBtn = document.getElementById('stopInterview');
                const feedbackCard = document.getElementById('feedbackCard');
                
                // Stop recording only if in online mode
                if (!offlineMode && mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                
                // Stop camera stream only if it exists
                if (mediaStream) {
                    mediaStream.getTracks().forEach(track => track.stop());
                    mediaStream = null;
                }
                
                // Update UI
                if (video) {
                    video.style.display = 'none';
                    video.srcObject = null;
                }
                if (placeholder) placeholder.style.display = 'block';
                if (startBtn) startBtn.style.display = 'block';
                if (stopBtn) stopBtn.style.display = 'none';
                
                // Clear timer
                let timeSpent = 300; // Default 5 minutes
                if (interviewTimer) {
                    clearInterval(interviewTimer);
                    const timerDisplay = document.getElementById('timer');
                    if (timerDisplay) {
                        const timeText = timerDisplay.textContent;
                        const [mins, secs] = timeText.split(':').map(Number);
                        timeSpent = 300 - (mins * 60 + secs);
                    }
                }
                
                const modeLabel = offlineMode ? '(Offline Practice)' : '(Recorded)';
                showNotification(`⏹ Interview stopped ${modeLabel}. Analyzing...`, 'info');
                
                // Save session data
                saveSession({
                    type: 'interview',
                    duration: timeSpent,
                    score: 82,
                    withCamera: !offlineMode
                });
                
                // Show feedback after a short delay
                setTimeout(() => {
                    if (feedbackCard) {
                        feedbackCard.style.display = 'block';
                    }
                    
                    const feedbackMsg = offlineMode ? 
                        `Interview Practice Complete!\n\nPractice Session:\n\nDuration: ${Math.floor(timeSpent / 60)}min ${timeSpent % 60}s\n\nYou practiced answering interview questions without camera recording.\n\nFeedback:\n+ Good effort in thinking through questions\n+ Practice builds confidence\n+ Review the concepts covered\n\nNext Steps:\n1. Enable camera when ready\n2. Practice with video recording\n3. Review your answers\n4. Refine your approach\n\nKeep practicing!` :
                        `Interview Complete!\n\nDuration: ${Math.floor(timeSpent / 60)}min ${timeSpent % 60}s\n\nAnalysis Results:\n\nScore: 82/100\n\nStrengths:\n+ Clear communication\n+ Technical accuracy\n+ Good problem-solving approach\n+ Maintained eye contact\n\nAreas to Improve:\n- Speak more concisely\n- Add more specific examples\n- Manage time better\n\nYou're improving! Keep practicing!`;
                    
                    showAlert(feedbackMsg);
                    offlineMode = false; // Reset offline mode
                }, 1000);
                
            } catch (error) {
                console.error('Error stopping interview:', error);
                showNotification('Error stopping interview: ' + error.message, 'error');
                offlineMode = false; // Reset on error
            }
        }

        function startInterviewTimer() {
            let timeLeft = 300; // 5 minutes in seconds
            const timerDisplay = document.getElementById('timer');
            
            interviewTimer = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                const timeString = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (timerDisplay) {
                    timerDisplay.textContent = timeString;
                    
                    // Change color when time is running out
                    if (timeLeft <= 60) {
                        timerDisplay.style.color = 'var(--warning)';
                    }
                    if (timeLeft <= 30) {
                        timerDisplay.style.color = 'var(--error)';
                    }
                }
                
                // Auto stop when time is up
                if (timeLeft <= 0) {
                    clearInterval(interviewTimer);
                    stopInterview();
                    showNotification('⏰ Interview time is up!', 'warning');
                }
            }, 1000);
        }

        // ==================== LAB FUNCTIONS ====================
        function runLabCode() {
            const code = document.getElementById('labCode')?.value || '';
            const output = document.getElementById('labOutput');
            
            if (!code.trim()) {
                showNotification('Please write some code first', 'error');
                return;
            }
            
            if (!output) return;
            
            showNotification('▶ Executing code...', 'info');
            output.innerHTML = `<div style="padding: 15px; color: var(--text);"><p style="color: var(--muted); font-size: 0.9rem;">⏳ Compiling and running code...</p></div>`;
            
            setTimeout(() => {
                let result = `
<div style="padding: 15px;">
    <h4 style="color: var(--success); margin-bottom: 10px; font-weight: 600;">✓ Execution Successful</h4>
    
    <div style="background: rgba(14, 165, 164, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px;">
        <p style="color: var(--muted); font-weight: 600; margin-bottom: 8px;">Output:</p>
        <pre style="color: var(--text); font-family: monospace; margin: 0; white-space: pre-wrap;">Model trained successfully!
R² Score: 0.872
Mean Squared Error: 15.34
Training Time: 2.34s
Memory Used: 45.2 MB</pre>
    </div>
    
    <div style="background: rgba(34, 197, 94, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--success);">
        <p style="color: var(--success); font-weight: 600; margin-bottom: 8px;">✅ Test Cases</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 1: PASSED (Input validation)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 2: PASSED (Data preprocessing)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 3: PASSED (Model training)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 4: PASSED (Accuracy calculation)</p>
        <p style="color: var(--warning); font-size: 0.9rem; margin: 5px 0;">⚠ Test 5: FAILED (Edge case handling)</p>
        <p style="color: var(--muted); font-size: 0.85rem; margin-top: 8px;">4/5 test cases passed (80%)</p>
    </div>
    
    <div style="background: rgba(59, 130, 246, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--primary);">
        <p style="color: var(--primary); font-weight: 600; margin-bottom: 8px;">Performance Analysis</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Execution Time: 2.34 seconds</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Memory Usage: 45.2 MB (Good)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Code Quality Score: 8.5/10</p>
    </div>
    
    <div style="background: rgba(249, 115, 22, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--warning);">
        <p style="color: var(--warning); font-weight: 600; margin-bottom: 8px;">Code Suggestions</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">1. Consider normalizing input features for better performance</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">2. Add input validation for edge cases</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">3. Use batch processing for large datasets</p>
    </div>
    
    <div style="display: flex; gap: 10px;">
        <button class="btn-primary" style="flex: 1;" onclick="submitLab()">Submit Solution</button>
        <button class="btn-secondary" style="flex: 1;" onclick="getLabHint()">Get Hint</button>
    </div>
</div>
                `;
                output.innerHTML = result;
            }, 2000);
        }

        function getLabHint() {
            const hints = [
                'Consider using a more efficient data structure like a HashMap',
                'Try breaking the problem into smaller helper functions',
                'Look for patterns in the test cases that fail',
                'Handle edge cases explicitly (empty, null, single element)',
                'Optimize your loops - can you reduce nested iterations?'
            ];
            const hint = hints[Math.floor(Math.random() * hints.length)];
            showNotification(hint, 'info');
        }

        function submitLab() {
            const code = document.getElementById('labCode')?.value || '';
            if (!code.trim()) {
                showNotification('Please write code and run tests first', 'error');
                return;
            }
            showNotification('Submitting lab solution...', 'info');
            setTimeout(() => {
                showAlert(`✅ Lab Submitted Successfully!\n\nYour Score: 92/100\n\n✓ Correct: 4/5 test cases\n⏱ Time: 8:34 minutes\nCode Quality: Excellent\n\nFeedback:\nGreat implementation! Your solution is clean and efficient. You earned 50 XP points!\n\nNext: Work on edge case handling in Test 5`);
                // Update lab stats
                if (document.getElementById('labsAttempted')) {
                    document.getElementById('labsAttempted').textContent = parseInt(document.getElementById('labsAttempted').textContent) + 1;
                }
            }, 1500);
        }

        // ==================== LEARNING PATH DISPLAY ====================
        function displayLearningPathOverview() {
            initializeCourses();
        }

        // Course Functions (backward compatible)
        function continueLearning(courseName) {
            const course = coursesData.find(c => c.name === courseName);
            if (course) {
                continueCourse(courseName, course.id);
            } else {
                showAlert(`Resuming "${courseName}"...\n\nLoading your progress and next lesson...`);
                switchDashboard('courses');
            }
        }

        // Additional helper functions
        function updateUserStats() {
            if (currentUser) {
                document.getElementById('statPoints').textContent = currentUser.points || 0;
                document.getElementById('statBadges').textContent = (currentUser.badges || []).length;
            }
        }

        // ==================== CHATGPT API CONFIGURATION ====================
        const CHATGPT_CONFIG = {
            apiKey: localStorage.getItem('chatgptApiKey') || '',
            model: 'gpt-3.5-turbo', // Using available GPT model
            maxTokens: 2500,
            temperature: 0.7,
            useOnline: true, // Prioritize online connection
            retryAttempts: 3, // Retry failed requests
            retryDelay: 1000 // Wait 1 second between retries
        };

        // Function to set ChatGPT API Key
        function setChatGPTKey(apiKey) {
            if (apiKey && apiKey.trim()) {
                CHATGPT_CONFIG.apiKey = apiKey;
                localStorage.setItem('chatgptApiKey', apiKey);
                showNotification('ChatGPT API Key saved successfully!', 'success');
                console.log('✅ ChatGPT API key configured - Online AI Tutor enabled');
                return true;
            } else {
                showNotification('Invalid API Key', 'error');
                return false;
            }
        }

        // Function to get ChatGPT response with retry logic
        async function getChatGPTResponse(userMessage) {
            // Check if API key is configured
            if (!CHATGPT_CONFIG.apiKey) {
                console.warn('ChatGPT API Key not configured');
                return null; // Will trigger fallback to knowledge base
            }

            if (!CHATGPT_CONFIG.useOnline) {
                console.log('Online mode disabled');
                return null;
            }

            // Check if server is running
            try {
                const serverCheck = await fetch('http://localhost:3000/api/leaderboard', { 
                    method: 'GET',
                    signal: AbortSignal.timeout(2000)
                }).catch(() => null);
                
                if (!serverCheck) {
                    console.warn('Server not running on localhost:3000 - falling back to offline');
                    showNotification('Server not running - using offline mode', 'warning');
                    return null;
                }
            } catch (e) {
                console.warn('Server check failed:', e.message);
                return null;
            }

            // Retry logic with exponential backoff
            for (let attempt = 1; attempt <= CHATGPT_CONFIG.retryAttempts; attempt++) {
                try {
                    console.log(`ChatGPT API call attempt ${attempt}/${CHATGPT_CONFIG.retryAttempts}...`);
                    
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 30000); // 30 second timeout for better responses

                    // Send request to backend server for secure API handling
                    const response = await fetch('http://localhost:3000/api/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            apiKey: CHATGPT_CONFIG.apiKey,
                            model: CHATGPT_CONFIG.model,
                            message: userMessage,
                            maxTokens: CHATGPT_CONFIG.maxTokens,
                            temperature: CHATGPT_CONFIG.temperature
                        }),
                        signal: controller.signal
                    });

                    clearTimeout(timeoutId);

                    if (!response.ok) {
                        const errorData = await response.json().catch(() => ({}));
                        const errorMessage = errorData?.error?.message || errorData?.error || 'Unknown error';
                        
                        console.error(`Attempt ${attempt} failed - Status: ${response.status}`);
                        
                        if (response.status === 401) {
                            console.warn('Invalid or expired API Key');
                            showNotification('Invalid API Key - Please check your configuration', 'error');
                            return null; // Don't retry invalid key
                        } else if (response.status === 429) {
                            console.warn('Rate limit exceeded - retrying...');
                            if (attempt < CHATGPT_CONFIG.retryAttempts) {
                                await new Promise(resolve => setTimeout(resolve, CHATGPT_CONFIG.retryDelay * attempt));
                                continue; // Retry
                            }
                        } else if (response.status === 503) {
                            console.warn('Service temporarily unavailable - retrying...');
                            if (attempt < CHATGPT_CONFIG.retryAttempts) {
                                await new Promise(resolve => setTimeout(resolve, CHATGPT_CONFIG.retryDelay * attempt));
                                continue; // Retry
                            }
                        }
                        
                        if (attempt === CHATGPT_CONFIG.retryAttempts) {
                            console.error(`Final attempt failed: ${errorMessage}`);
                        }
                        continue; // Try next attempt
                    }

                    const data = await response.json();
                    const content = data.content || data.message;
                    
                    if (content) {
                        console.log('✅ ChatGPT response received successfully');
                        return content;
                    } else {
                        console.warn('Empty response from ChatGPT');
                        if (attempt === CHATGPT_CONFIG.retryAttempts) {
                            return null;
                        }
                        await new Promise(resolve => setTimeout(resolve, CHATGPT_CONFIG.retryDelay));
                        continue;
                    }
                } catch (error) {
                    console.warn(`Attempt ${attempt} error:`, error.message);
                    
                    if (error.name === 'AbortError') {
                        console.warn('Request timed out - retrying...');
                    } else if (error instanceof TypeError) {
                        console.warn('Network error - retrying...');
                    }
                    
                    if (attempt < CHATGPT_CONFIG.retryAttempts) {
                        await new Promise(resolve => setTimeout(resolve, CHATGPT_CONFIG.retryDelay * attempt));
                        continue; // Retry
                    } else {
                        console.error('All retry attempts failed');
                        return null;
                    }
                }
            }
            
            return null; // All retries failed
        }

        // ==================== AI TUTOR FUNCTIONS ====================
        const tutorResponses = {
            'binary search': {
                explanation: `Binary search is an efficient algorithm that works on sorted arrays. Here's how it works:\n\n1. Start with the middle element\n2. If target equals middle, you found it\n3. If target is smaller, search the left half\n4. If target is larger, search the right half\n5. Repeat until found or array is exhausted\n\nTime Complexity: O(log n)\nSpace Complexity: O(1)`,
                code: `function binarySearch(arr, target) {\n  let left = 0, right = arr.length - 1;\n  while (left <= right) {\n    const mid = Math.floor((left + right) / 2);\n    if (arr[mid] === target) return mid;\n    if (arr[mid] < target) left = mid + 1;\n    else right = mid - 1;\n  }\n  return -1;\n}`,
                source: 'Knowledge Base'
            },
            'dynamic programming': {
                explanation: `Dynamic Programming is an optimization technique that solves complex problems by breaking them into simpler overlapping subproblems.\n\nKey Concepts:\n1. Optimal Substructure: Problem has optimal solution from subproblems\n2. Overlapping Subproblems: Same subproblems solved repeatedly\n3. Memoization: Store results to avoid recalculation\n4. Bottom-up Approach: Build solutions from simple to complex\n\nCommon Examples:\n- Fibonacci sequence\n- Coin change problem\n- Longest common subsequence\n- 0/1 Knapsack`,
                code: `// Fibonacci with Memoization\nfunction fibonacci(n, memo = {}) {\n  if (n in memo) return memo[n];\n  if (n <= 1) return n;\n  memo[n] = fibonacci(n-1, memo) + fibonacci(n-2, memo);\n  return memo[n];\n}\n\n// Bottom-up approach\nfunction fibonacciTabulation(n) {\n  const dp = [0, 1];\n  for (let i = 2; i <= n; i++) {\n    dp[i] = dp[i-1] + dp[i-2];\n  }\n  return dp[n];\n}`,
                source: 'Knowledge Base'
            },
            'graph algorithms': {
                explanation: `Graph Algorithms are used to solve problems on graph structures.\n\nCommon Algorithms:\n1. BFS (Breadth-First Search): Level-by-level exploration\n2. DFS (Depth-First Search): Deep exploration using stack\n3. Dijkstra: Find shortest path with weights\n4. Topological Sort: Order vertices with dependencies\n5. Union-Find: Check connectivity efficiently\n\nApplications:\n- Social networks (friend suggestions)\n- Navigation (GPS routing)\n- Network connectivity\n- Recommendation systems`,
                code: `// BFS Implementation\nfunction bfs(graph, start) {\n  const visited = new Set();\n  const queue = [start];\n  const result = [];\n  \n  while (queue.length > 0) {\n    const node = queue.shift();\n    if (!visited.has(node)) {\n      visited.add(node);\n      result.push(node);\n      queue.push(...graph[node]);\n    }\n  }\n  return result;\n}`,
                source: 'Knowledge Base'
            },
            'recursion': {
                explanation: `Recursion is when a function calls itself to solve smaller versions of the same problem.\n\nKey Components:\n1. Base Case: Condition to stop recursion\n2. Recursive Case: Function calls itself with simpler input\n3. Trust: Assume recursive calls work correctly\n\nWhen to Use:\n- Tree/Graph traversal\n- Factorial calculation\n- Quick Sort/Merge Sort\n- Backtracking problems\n\nWhen to Avoid:\n- Large input sizes (stack overflow risk)\n- When iteration is simpler`,
                code: `// Factorial - Simple Recursion\nfunction factorial(n) {\n  if (n <= 1) return 1; // Base case\n  return n * factorial(n - 1); // Recursive case\n}\n\n// Tree Traversal - Complex Recursion\nfunction traverseTree(node) {\n  if (!node) return; // Base case\n  console.log(node.value);\n  traverseTree(node.left);\n  traverseTree(node.right);\n}`,
                source: 'Knowledge Base'
            }
        };

        async function askAITutor() {
            try {
                console.log('askAITutor function called');
                
                const problem = document.getElementById('tutorProblem')?.value || '';
                console.log('Problem text:', problem);
                
                if (!problem.trim()) {
                    showNotification('Please describe your problem', 'error');
                    console.warn('Problem text is empty');
                    return;
                }
                
                const responseBox = document.getElementById('tutorResponseBox');
                if (!responseBox) {
                    showNotification('AI Tutor interface not found. Please refresh the page.', 'error');
                    console.error('tutorResponseBox element not found');
                    return;
                }
                
                console.log('Response box found');
                
                // Check if we have an API key
                const hasApiKey = CHATGPT_CONFIG.apiKey && CHATGPT_CONFIG.apiKey.trim().length > 0;
                const isOnline = navigator.onLine && isNetworkOnline;
                const serverReachable = serverStatus.connected;
                
                console.log('🔍 Status Check:');
                console.log('  • API Key:', hasApiKey ? '✅ Configured' : '❌ Not configured');
                console.log('  • Browser Online:', isOnline ? '✅ Yes' : '❌ No');
                console.log('  • Server Status:', serverReachable ? '✅ Connected' : '❌ Disconnected');
                console.log('  • Auto-Connect Enabled:', AUTO_CONNECT_CONFIG.enabled ? '✅ Yes' : '❌ No');
                
                // PRIORITY 1: Try online ChatGPT if internet is available (auto-connect system)
                if (hasApiKey && isOnline && serverReachable && CHATGPT_CONFIG.useOnline && AUTO_CONNECT_CONFIG.enabled) {
                    console.log('\n🌐 PRIORITY 1: Using Internet Connection - ChatGPT (GPT-4)');
                    showNotification('📡 Internet Available - Fetching answer from ChatGPT...', 'info');
                    
                    // Show loading state with internet indicator
                    responseBox.style.display = 'block';
                    responseBox.innerHTML = `
                        <div style="background: linear-gradient(135deg, rgba(14, 165, 164, 0.15), rgba(6, 182, 212, 0.15)); padding: 20px; border-radius: 8px; text-align: center; border: 1px solid rgba(14, 165, 164, 0.3);">
                            <p style="color: var(--success); margin-bottom: 8px; font-weight: 600;">🌐 Connected to Internet</p>
                            <p style="color: var(--muted); margin-bottom: 12px; font-size: 0.9rem;">Connecting to ChatGPT GPT-4 for premium AI answers...</p>
                            <div style="display: inline-block; padding: 10px 20px; background: rgba(14, 165, 164, 0.25); border-radius: 6px; border: 1px solid rgba(14, 165, 164, 0.4);">
                                <p style="color: var(--primary); font-size: 0.85rem; margin: 0;">⚡ Analyzing your question...</p>
                            </div>
                        </div>
                    `;
                    
                    // Get response from ChatGPT with retry logic
                    const gptResponse = await getChatGPTResponse(problem);
                    
                    if (gptResponse) {
                        // Parse response for code snippets
                        const codeBlockRegex = /```[\w]*\n?([\s\S]*?)```/g;
                        const codeMatches = [...gptResponse.matchAll(codeBlockRegex)];
                        let explanation = gptResponse.replace(codeBlockRegex, ' [CODE BLOCK] ');
                        let code = codeMatches.length > 0 ? codeMatches[0][1].trim() : null;
                        
                        if (explanation.trim()) {
                            displayTutorResponse({
                                explanation: explanation.trim(),
                                code: code,
                                isFromGPT: true,
                                source: '🌐 ChatGPT (GPT-4) - Internet',
                                isInternetAnswer: true
                            });
                            showNotification('✅ ChatGPT Response Ready! (Premium AI)', 'success');
                            console.log('✅ Successfully delivered internet-based answer');
                            return;
                        }
                    }
                    console.log('⚠️ ChatGPT response unavailable, falling back to offline');
                    showNotification('ChatGPT temporarily unavailable - using offline knowledge base', 'warning');
                }
                
                // PRIORITY 2: If internet available but API key missing or server unreachable
                if (isOnline && !hasApiKey) {
                    console.log('\n⚠️ PRIORITY 2: Internet Available but No API Key Configured');
                    showNotification('📡 Internet Available - But API Key not configured. Using offline mode.', 'info');
                }
                
                // PRIORITY 3: Fallback - Use offline knowledge base
                console.log('\n💾 PRIORITY 3: Using Offline Knowledge Base');
                showNotification('📚 Using offline knowledge base for answer', 'info');
                handleOfflineAITutor(problem);
                
            } catch (error) {
                console.error('Error in askAITutor:', error);
                showNotification('Switching to offline mode', 'warning');
                const problem = document.getElementById('tutorProblem')?.value || '';
                if (problem.trim()) {
                    handleOfflineAITutor(problem);
                }
            }
        }

        function handleOfflineAITutor(problem) {
            // Guaranteed offline response handler
            console.log('handleOfflineAITutor called with problem:', problem);
            
            const responseBox = document.getElementById('tutorResponseBox');
            if (!responseBox) {
                console.error('❌ tutorResponseBox element not found');
                return;
            }
            
            const lowerProblem = problem.toLowerCase();
            let response;
            
            // Try to match known topics
            if (lowerProblem.includes('binary') && lowerProblem.includes('search')) {
                console.log('✅ Matched: binary search');
                response = tutorResponses['binary search'];
            } else if (lowerProblem.includes('dynamic') && lowerProblem.includes('program')) {
                console.log('✅ Matched: dynamic programming');
                response = tutorResponses['dynamic programming'];
            } else if (lowerProblem.includes('graph')) {
                console.log('✅ Matched: graph algorithms');
                response = tutorResponses['graph algorithms'];
            } else if (lowerProblem.includes('recurs')) {
                console.log('✅ Matched: recursion');
                response = tutorResponses['recursion'];
            } else {
                console.log('ℹ️ No specific match, using generic fallback');
                // Generic fallback for any question
                response = {
                    explanation: `Offline Response for: "${problem.substring(0, 40)}${problem.length > 40 ? '...' : ''}"\n\nProblem-Solving Framework:\n\n1. **Understand the Problem**\n   • Read carefully and identify key details\n   • Look for constraints and edge cases\n   • Ask clarifying questions if needed\n\n2. **Plan Your Approach**\n   • Think of similar problems you've seen\n   • Sketch out a solution approach\n   • Consider time and space complexity\n\n3. **Code Incrementally**\n   • Start with brute force\n   • Test with sample inputs\n   • Optimize once it works\n\n4. **Optimize & Refactor**\n   • Reduce time complexity\n   • Reduce space usage\n   • Clean up the code\n\n5. **Edge Cases**\n   • Empty input\n   • Single element\n   • Large inputs\n   • Negative numbers\n   • Boundary values\n\nTips:\n✓ Use appropriate data structures\n✓ Break problems into subproblems\n✓ Comment your code\n✓ Practice similar problems\n✓ Explain your solution aloud`,
                    code: `// Generic Problem-Solving Template\n\nfunction solveProblem(input) {\n  // Step 1: Input Validation\n  if (!input || input.length === 0) {\n    return null; // Handle edge case\n  }\n  \n  // Step 2: Initialize Variables\n  let result = null;\n  const n = input.length;\n  \n  // Step 3: Main Algorithm\n  // TODO: Implement your solution here\n  \n  // Step 4: Verification\n  // Check edge cases and constraints\n  \n  // Step 5: Return Result\n  return result;\n}\n\n// Test Cases\nconsole.log(solveProblem([])); // Edge case\nconsole.log(solveProblem([1])); // Single element\nconsole.log(solveProblem([1, 2, 3])); // Normal case`,
                    source: 'Offline Knowledge Base'
                };
            }
            
            console.log('↓ Calling displayTutorResponse with response:', response);
            displayTutorResponse(response);
            showNotification('✅ Offline Response Ready!', 'success');
            console.log('✅ AI Tutor operating in offline mode - response displayed');
        }

        function displayTutorResponse(response) {
            const responseBox = document.getElementById('tutorResponseBox');
            const responseText = document.getElementById('tutorResponse');
            const codeSnippet = document.getElementById('codeSnippet');
            const snippetCode = document.getElementById('snippetCode');
            
            console.log('displayTutorResponse called with:', response);
            
            if (!responseBox) {
                console.error('❌ tutorResponseBox element not found');
                return;
            }
            
            if (!responseText) {
                console.error('❌ tutorResponse element not found');
                return;
            }
            
            // Prepare source badge
            const source = response.source || (response.isFromGPT ? 'ChatGPT' : 'Knowledge Base');
            const sourceBadge = `<div style="margin-bottom: 12px; padding: 8px 12px; background: rgba(14, 165, 164, 0.15); border-left: 3px solid var(--primary); border-radius: 4px;">
                <small style="color: var(--muted);">Source: ${source}</small>
            </div>`;
            
            // Format explanation with proper HTML for newlines
            const formattedExplanation = (response.explanation || '')
                .split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0)
                .map(line => {
                    // Add line break styling for numbered items and bullet points
                    if (line.match(/^[\d•✓✗\-]/)) {
                        return `<div style="margin: 8px 0; padding-left: 12px;">${line}</div>`;
                    }
                    return `<div style="margin: 6px 0;">${line}</div>`;
                })
                .join('');
            
            console.log('✅ Setting responseBox.style.display = block');
            responseBox.style.display = 'block';
            
            console.log('✅ Setting responseText.innerHTML');
            responseText.innerHTML = sourceBadge + formattedExplanation;
            
            if (response.code) {
                console.log('✅ Setting code snippet visible');
                codeSnippet.style.display = 'block';
                snippetCode.textContent = response.code;
            } else {
                codeSnippet.style.display = 'none';
            }
            
            // Scroll to response so user can see it
            setTimeout(() => {
                responseBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
            
            console.log('✅ displayTutorResponse completed successfully');
            
            // Save tutor session
            const problem = document.getElementById('tutorProblem')?.value || 'Unknown question';
            saveSession({
                type: 'aiTutor',
                question: problem,
                source: source,
                hasCode: !!response.code
            });
        }

        async function getCodeHint() {
            const problem = document.getElementById('tutorProblem')?.value || '';
            if (!problem.trim()) {
                showNotification('Please describe your problem first', 'error');
                return;
            }
            showNotification('ChatGPT is generating a code hint...', 'info');
            
            const hintMessage = `Provide a helpful code hint (not the full solution) for this problem: ${problem}\n\nGive only the hint, no full code.`;
            const hint = await getChatGPTResponse(hintMessage);
            
            if (hint) {
                displayTutorResponse({
                    explanation: `Code Hint from ChatGPT:\n\n${hint}\n\nRemember:\n✓ Start simple, then optimize\n✓ Test with sample inputs\n✓ Check boundary conditions\n✓ Refactor for clarity\n\nWould you like a more specific hint or the full solution?`,
                    isFromGPT: true
                });
                showNotification('✅ ChatGPT Hint Generated!', 'success');
            } else {
                // Fallback to local hints
                const hints = [
                    'Start by understanding the input constraints and output requirements.',
                    'Consider the data structure that would best represent this problem.',
                    'Think about the time complexity you want to achieve.',
                    'Write pseudocode before implementing the actual code.',
                    'Break the problem into smaller helper functions.',
                    'Consider edge cases like empty input, single element, duplicates.',
                    'Use console.log to debug and verify your logic step by step.'
                ];
                const randomHint = hints[Math.floor(Math.random() * hints.length)];
                displayTutorResponse({
                    explanation: `Code Hint for You:\n\n${randomHint}\n\nRemember:\n✓ Start simple, then optimize\n✓ Test with sample inputs\n✓ Check boundary conditions\n✓ Refactor for clarity\n\nWould you like a more specific hint or the full solution?`
                });
                showNotification('✅ Hint Generated!', 'success');
            }
        }

        async function getExplanation() {
            const problem = document.getElementById('tutorProblem')?.value || '';
            if (!problem.trim()) {
                showNotification('Please describe your problem first', 'error');
                return;
            }
            showNotification('ChatGPT is creating detailed explanation...', 'info');
            
            const explanationMessage = `Provide a detailed, step-by-step explanation for solving this problem: ${problem}\n\nInclude:\n1. Problem Analysis\n2. Solution Strategy\n3. Implementation tips\n4. Testing approach\n5. Optimization suggestions`;
            const explanation = await getChatGPTResponse(explanationMessage);
            
            if (explanation) {
                displayTutorResponse({
                    explanation: `Detailed Explanation from ChatGPT:\n\n${explanation}`,
                    isFromGPT: true
                });
                showNotification('✅ ChatGPT Explanation Ready!', 'success');
            } else {
                // Fallback to local explanation
                displayTutorResponse({
                    explanation: `Detailed Explanation\n\nProblem: ${problem.substring(0, 50)}...\n\nApproach:\n1. Problem Analysis\n   - Understand what's being asked\n   - Identify input/output\n   - Note constraints\n\n2. Solution Strategy\n   - Choose algorithm/data structure\n   - Plan time complexity\n   - Consider space optimization\n\n3. Implementation\n   - Code the solution\n   - Handle edge cases\n   - Add error checking\n\n4. Testing\n   - Test with examples\n   - Test edge cases\n   - Verify complexity\n\n5. Optimization\n   - Refactor if needed\n   - Improve readability\n   - Consider alternatives`,
                    code: `// Step-by-step template\nfunction solve(input) {\n  // Step 1: Validate input\n  if (!input) return null;\n  \n  // Step 2: Initialize data structures\n  const result = [];\n  \n  // Step 3: Process input\n  for (let item of input) {\n    // Process each item\n  }\n  \n  // Step 4: Return formatted result\n  return result;\n}`
                });
                showNotification('✅ Explanation Ready!', 'success');
            }
        }

        function rateTutorResponse(rating) {
            if (rating === 'helpful') {
                showNotification('Thank you! Your feedback helps improve the AI', 'success');
            } else {
                showNotification('We\'ll improve! Send us feedback in Community', 'info');
            }
            // Update tutor stats
            const problemsSolved = document.getElementById('problemsSolved');
            if (problemsSolved && rating === 'helpful') {
                problemsSolved.textContent = parseInt(problemsSolved.textContent) + 1;
            }
        }

        function clearTutorResponse() {
            document.getElementById('tutorProblem').value = '';
            document.getElementById('tutorResponseBox').style.display = 'none';
            showNotification('✨ Ready for next question', 'info');
        }

        function loadTutorTopic(topic) {
            document.getElementById('tutorProblem').value = `Can you explain ${topic} with examples and code?`;
            askAITutor();
        }

        // Function to show ChatGPT Settings Modal
        function showChatGPTSettings() {
            const currentKey = CHATGPT_CONFIG.apiKey ? CHATGPT_CONFIG.apiKey.substring(0, 10) + '...' : 'Not set';
            const settingsModal = document.createElement('div');
            settingsModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            settingsModal.innerHTML = `
                <div class="card" style="width: 90%; max-width: 600px; padding: 30px; position: relative;">
                    <button onclick="this.closest('div[style*=\\'position: fixed\\']').remove()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--muted);">✕</button>
                    
                    <h2 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 20px;">⚙️ ChatGPT Integration Settings</h2>
                    
                    <div style="background: rgba(14, 165, 164, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--primary);">
                        <p style="color: var(--muted); margin-bottom: 10px;">Current API Key Status:</p>
                        <p style="color: var(--text); font-weight: 600;">${currentKey}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text); margin-bottom: 8px; font-weight: 600;">OpenAI API Key</label>
                        <input type="password" id="chatgptApiKeyInput" placeholder="sk-..." style="width: 100%; padding: 12px; background: rgba(14, 165, 164, 0.1); border: 1px solid rgba(14, 165, 164, 0.3); border-radius: 8px; color: var(--text); font-family: monospace;" value="${CHATGPT_CONFIG.apiKey}">
                    </div>
                    
                    <div style="background: rgba(249, 115, 22, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--warning);">
                        <p style="color: var(--warning); font-weight: 600; margin-bottom: 10px;">How to get your API Key:</p>
                        <ol style="color: var(--muted); font-size: 0.9rem; margin-left: 20px;">
                            <li>Visit <span style="color: var(--primary);">https://platform.openai.com/api-keys</span></li>
                            <li>Sign in with your OpenAI account</li>
                            <li>Click "Create new secret key"</li>
                            <li>Copy and paste it here</li>
                            <li>Your key is stored locally - never shared with anyone</li>
                        </ol>
                    </div>
                    
                    <div style="background: rgba(34, 197, 94, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--success);">
                        <p style="color: var(--success); font-weight: 600; margin-bottom: 8px;">✅ Benefits of Integration:</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Get accurate, real-time coding solutions</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Personalized explanations for any topic</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Advanced code hints and suggestions</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Better problem-solving assistance</p>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-primary" style="flex: 1; padding: 12px;" onclick="saveChatGPTSettings()">Save API Key</button>
                        <button class="btn-secondary" style="flex: 1; padding: 12px;" onclick="testChatGPTConnection()">Test Connection</button>
                        <button class="btn-secondary" style="flex: 1; padding: 12px;" onclick="this.closest('div[style*=\\'position: fixed\\']').remove()">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(settingsModal);
        }

        // Save ChatGPT API Key
        function saveChatGPTSettings() {
            const apiKey = document.getElementById('chatgptApiKeyInput')?.value || '';
            if (setChatGPTKey(apiKey)) {
                showNotification('✅ API Key saved successfully!', 'success');
                updateChatGPTSetupNotice(); // Update the notice visibility
                setTimeout(() => {
                    // Close the modal
                    const modal = document.querySelector('div[style*="position: fixed"]');
                    if (modal) modal.remove();
                }, 500);
            }
        }

        // Test ChatGPT Connection
        async function testChatGPTConnection() {
            if (!CHATGPT_CONFIG.apiKey) {
                showNotification('❌ Please enter an API Key first', 'error');
                return;
            }
            
            showNotification('Testing ChatGPT connection...', 'info');
            const testResponse = await getChatGPTResponse('Say "ChatGPT connection successful" in exactly one sentence.');
            
            if (testResponse) {
                showNotification('✅ ChatGPT connection successful!', 'success');
                showAlert(`Connection Test Result:\n\n✅ API Key is valid\n✅ Connection to OpenAI is working\n✅ ChatGPT is ready to use\n\nResponse: ${testResponse}`);
                updateChatGPTSetupNotice();
            } else {
                showNotification('❌ Connection test failed', 'error');
            }
        }

        // ==================== ENHANCED LAB CODE EXECUTION ====================
        function runLabCode() {
            const code = document.getElementById('labCode')?.value || '';
            const output = document.getElementById('labOutput');
            
            if (!code.trim()) {
                showNotification('Please write some code first', 'error');
                return;
            }
            
            if (!output) return;
            
            showNotification('▶ Executing code...', 'info');
            output.innerHTML = `<div style="padding: 15px; color: var(--text);"><p style="color: var(--muted); font-size: 0.9rem;">⏳ Compiling and running code...</p></div>`;
            
            setTimeout(() => {
                let result = `
<div style="padding: 15px;">
    <h4 style="color: var(--success); margin-bottom: 10px; font-weight: 600;">✓ Execution Successful</h4>
    
    <div style="background: rgba(14, 165, 164, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px;">
        <p style="color: var(--muted); font-weight: 600; margin-bottom: 8px;">Output:</p>
        <pre style="color: var(--text); font-family: monospace; margin: 0; white-space: pre-wrap;">Model trained successfully!
R² Score: 0.872
Mean Squared Error: 15.34
Training Time: 2.34s
Memory Used: 45.2 MB</pre>
    </div>
    
    <div style="background: rgba(34, 197, 94, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--success);">
        <p style="color: var(--success); font-weight: 600; margin-bottom: 8px;">✅ Test Cases</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 1: PASSED (Input validation)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 2: PASSED (Data preprocessing)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 3: PASSED (Model training)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">✓ Test 4: PASSED (Accuracy calculation)</p>
        <p style="color: var(--warning); font-size: 0.9rem; margin: 5px 0;">⚠ Test 5: FAILED (Edge case handling)</p>
        <p style="color: var(--muted); font-size: 0.85rem; margin-top: 8px;">4/5 test cases passed (80%)</p>
    </div>
    
    <div style="background: rgba(59, 130, 246, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--primary);">
        <p style="color: var(--primary); font-weight: 600; margin-bottom: 8px;">Performance Analysis</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Execution Time: 2.34 seconds</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Memory Usage: 45.2 MB (Good)</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">• Code Quality Score: 8.5/10</p>
    </div>
    
    <div style="background: rgba(249, 115, 22, 0.1); padding: 12px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid var(--warning);">
        <p style="color: var(--warning); font-weight: 600; margin-bottom: 8px;">Code Suggestions</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">1. Consider normalizing input features for better performance</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">2. Add input validation for edge cases</p>
        <p style="color: var(--text); font-size: 0.9rem; margin: 5px 0;">3. Use batch processing for large datasets</p>
    </div>
    
    <div style="display: flex; gap: 10px;">
        <button class="btn-primary" style="flex: 1;" onclick="submitLab()">Submit Solution</button>
        <button class="btn-secondary" style="flex: 1;" onclick="getLabHint()">Get Hint</button>
    </div>
</div>
                `;
                output.innerHTML = result;
            }, 2000);
        }

        function getLabHint() {
            const hints = [
                'Consider using a more efficient data structure like a HashMap',
                'Try breaking the problem into smaller helper functions',
                'Look for patterns in the test cases that fail',
                'Handle edge cases explicitly (empty, null, single element)',
                'Optimize your loops - can you reduce nested iterations?'
            ];
            const hint = hints[Math.floor(Math.random() * hints.length)];
            showNotification(hint, 'info');
        }

        function submitLab() {
            const code = document.getElementById('labCode')?.value || '';
            if (!code.trim()) {
                showNotification('Please write code and run tests first', 'error');
                return;
            }
            showNotification('Submitting lab solution...', 'info');
            setTimeout(() => {
                showAlert(`✅ Lab Submitted Successfully!\n\nYour Score: 92/100\n\n✓ Correct: 4/5 test cases\n⏱ Time: 8:34 minutes\nCode Quality: Excellent\n\nFeedback:\nGreat implementation! Your solution is clean and efficient. You earned 50 XP points!\n\nNext: Work on edge case handling in Test 5`);
                // Update lab stats
                if (document.getElementById('labsAttempted')) {
                    document.getElementById('labsAttempted').textContent = parseInt(document.getElementById('labsAttempted').textContent) + 1;
                }
            }, 1500);
        }

        // ==================== LEARNING PATH DISPLAY ====================
        function displayLearningPathOverview() {
            initializeCourses();
        }

        // Course Functions (backward compatible)
        function continueLearning(courseName) {
            const course = coursesData.find(c => c.name === courseName);
            if (course) {
                continueCourse(courseName, course.id);
            } else {
                showAlert(`Resuming "${courseName}"...\n\nLoading your progress and next lesson...`);
                switchDashboard('courses');
            }
        }

        // Additional helper functions
        function updateUserStats() {
            if (currentUser) {
                document.getElementById('statPoints').textContent = currentUser.points || 0;
                document.getElementById('statBadges').textContent = (currentUser.badges || []).length;
            }
        }

        // ==================== CHATGPT API CONFIGURATION ====================

        function handleOfflineAITutor(problem) {
            // Guaranteed offline response handler
            console.log('handleOfflineAITutor called with problem:', problem);
            
            const responseBox = document.getElementById('tutorResponseBox');
            if (!responseBox) {
                console.error('❌ tutorResponseBox element not found');
                return;
            }
            
            const lowerProblem = problem.toLowerCase();
            let response;
            
            // Try to match known topics
            if (lowerProblem.includes('binary') && lowerProblem.includes('search')) {
                console.log('✅ Matched: binary search');
                response = tutorResponses['binary search'];
            } else if (lowerProblem.includes('dynamic') && lowerProblem.includes('program')) {
                console.log('✅ Matched: dynamic programming');
                response = tutorResponses['dynamic programming'];
            } else if (lowerProblem.includes('graph')) {
                console.log('✅ Matched: graph algorithms');
                response = tutorResponses['graph algorithms'];
            } else if (lowerProblem.includes('recurs')) {
                console.log('✅ Matched: recursion');
                response = tutorResponses['recursion'];
            } else {
                console.log('ℹ️ No specific match, using generic fallback');
                // Generic fallback for any question
                response = {
                    explanation: `Offline Response for: "${problem.substring(0, 40)}${problem.length > 40 ? '...' : ''}"\n\nProblem-Solving Framework:\n\n1. **Understand the Problem**\n   • Read carefully and identify key details\n   • Look for constraints and edge cases\n   • Ask clarifying questions if needed\n\n2. **Plan Your Approach**\n   • Think of similar problems you've seen\n   • Sketch out a solution approach\n   • Consider time and space complexity\n\n3. **Code Incrementally**\n   • Start with brute force\n   • Test with sample inputs\n   • Optimize once it works\n\n4. **Optimize & Refactor**\n   • Reduce time complexity\n   • Reduce space usage\n   • Clean up the code\n\n5. **Edge Cases**\n   • Empty input\n   • Single element\n   • Large inputs\n   • Negative numbers\n   • Boundary values\n\nTips:\n✓ Use appropriate data structures\n✓ Break problems into subproblems\n✓ Comment your code\n✓ Practice similar problems\n✓ Explain your solution aloud`,
                    code: `// Generic Problem-Solving Template\n\nfunction solveProblem(input) {\n  // Step 1: Input Validation\n  if (!input || input.length === 0) {\n    return null; // Handle edge case\n  }\n  \n  // Step 2: Initialize Variables\n  let result = null;\n  const n = input.length;\n  \n  // Step 3: Main Algorithm\n  // TODO: Implement your solution here\n  \n  // Step 4: Verification\n  // Check edge cases and constraints\n  \n  // Step 5: Return Result\n  return result;\n}\n\n// Test Cases\nconsole.log(solveProblem([])); // Edge case\nconsole.log(solveProblem([1])); // Single element\nconsole.log(solveProblem([1, 2, 3])); // Normal case`,
                    source: 'Offline Knowledge Base'
                };
            }
            
            console.log('↓ Calling displayTutorResponse with response:', response);
            displayTutorResponse(response);
            showNotification('✅ Offline Response Ready!', 'success');
            console.log('✅ AI Tutor operating in offline mode - response displayed');
        }

        function displayTutorResponse(response) {
            const responseBox = document.getElementById('tutorResponseBox');
            const responseText = document.getElementById('tutorResponse');
            const codeSnippet = document.getElementById('codeSnippet');
            const snippetCode = document.getElementById('snippetCode');
            
            console.log('displayTutorResponse called with:', response);
            
            if (!responseBox) {
                console.error('❌ tutorResponseBox element not found');
                return;
            }
            
            if (!responseText) {
                console.error('❌ tutorResponse element not found');
                return;
            }
            
            // Prepare source badge
            const source = response.source || (response.isFromGPT ? 'ChatGPT' : 'Knowledge Base');
            const sourceBadge = `<div style="margin-bottom: 12px; padding: 8px 12px; background: rgba(14, 165, 164, 0.15); border-left: 3px solid var(--primary); border-radius: 4px;">
                <small style="color: var(--muted);">Source: ${source}</small>
            </div>`;
            
            // Format explanation with proper HTML for newlines
            const formattedExplanation = (response.explanation || '')
                .split('\n')
                .map(line => line.trim())
                .filter(line => line.length > 0)
                .map(line => {
                    // Add line break styling for numbered items and bullet points
                    if (line.match(/^[\d•✓✗\-]/)) {
                        return `<div style="margin: 8px 0; padding-left: 12px;">${line}</div>`;
                    }
                    return `<div style="margin: 6px 0;">${line}</div>`;
                })
                .join('');
            
            console.log('✅ Setting responseBox.style.display = block');
            responseBox.style.display = 'block';
            
            console.log('✅ Setting responseText.innerHTML');
            responseText.innerHTML = sourceBadge + formattedExplanation;
            
            if (response.code) {
                console.log('✅ Setting code snippet visible');
                codeSnippet.style.display = 'block';
                snippetCode.textContent = response.code;
            } else {
                codeSnippet.style.display = 'none';
            }
            
            // Scroll to response so user can see it
            setTimeout(() => {
                responseBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 100);
            
            console.log('✅ displayTutorResponse completed successfully');
            
            // Save tutor session
            const problem = document.getElementById('tutorProblem')?.value || 'Unknown question';
            saveSession({
                type: 'aiTutor',
                question: problem,
                source: source,
                hasCode: !!response.code
            });
        }

        async function getCodeHint() {
            const problem = document.getElementById('tutorProblem')?.value || '';
            if (!problem.trim()) {
                showNotification('Please describe your problem first', 'error');
                return;
            }
            showNotification('ChatGPT is generating a code hint...', 'info');
            
            const hintMessage = `Provide a helpful code hint (not the full solution) for this problem: ${problem}\n\nGive only the hint, no full code.`;
            const hint = await getChatGPTResponse(hintMessage);
            
            if (hint) {
                displayTutorResponse({
                    explanation: `Code Hint from ChatGPT:\n\n${hint}\n\nRemember:\n✓ Start simple, then optimize\n✓ Test with sample inputs\n✓ Check boundary conditions\n✓ Refactor for clarity\n\nWould you like a more specific hint or the full solution?`,
                    isFromGPT: true
                });
                showNotification('✅ ChatGPT Hint Generated!', 'success');
            } else {
                // Fallback to local hints
                const hints = [
                    'Start by understanding the input constraints and output requirements.',
                    'Consider the data structure that would best represent this problem.',
                    'Think about the time complexity you want to achieve.',
                    'Write pseudocode before implementing the actual code.',
                    'Break the problem into smaller helper functions.',
                    'Consider edge cases like empty input, single element, duplicates.',
                    'Use console.log to debug and verify your logic step by step.'
                ];
                const randomHint = hints[Math.floor(Math.random() * hints.length)];
                displayTutorResponse({
                    explanation: `Code Hint for You:\n\n${randomHint}\n\nRemember:\n✓ Start simple, then optimize\n✓ Test with sample inputs\n✓ Check boundary conditions\n✓ Refactor for clarity\n\nWould you like a more specific hint or the full solution?`
                });
                showNotification('✅ Hint Generated!', 'success');
            }
        }

        async function getExplanation() {
            const problem = document.getElementById('tutorProblem')?.value || '';
            if (!problem.trim()) {
                showNotification('Please describe your problem first', 'error');
                return;
            }
            showNotification('ChatGPT is creating detailed explanation...', 'info');
            
            const explanationMessage = `Provide a detailed, step-by-step explanation for solving this problem: ${problem}\n\nInclude:\n1. Problem Analysis\n2. Solution Strategy\n3. Implementation tips\n4. Testing approach\n5. Optimization suggestions`;
            const explanation = await getChatGPTResponse(explanationMessage);
            
            if (explanation) {
                displayTutorResponse({
                    explanation: `Detailed Explanation from ChatGPT:\n\n${explanation}`,
                    isFromGPT: true
                });
                showNotification('✅ ChatGPT Explanation Ready!', 'success');
            } else {
                // Fallback to local explanation
                displayTutorResponse({
                    explanation: `Detailed Explanation\n\nProblem: ${problem.substring(0, 50)}...\n\nApproach:\n1. Problem Analysis\n   - Understand what's being asked\n   - Identify input/output\n   - Note constraints\n\n2. Solution Strategy\n   - Choose algorithm/data structure\n   - Plan time complexity\n   - Consider space optimization\n\n3. Implementation\n   - Code the solution\n   - Handle edge cases\n   - Add error checking\n\n4. Testing\n   - Test with examples\n   - Test edge cases\n   - Verify complexity\n\n5. Optimization\n   - Refactor if needed\n   - Improve readability\n   - Consider alternatives`,
                    code: `// Step-by-step template\nfunction solve(input) {\n  // Step 1: Validate input\n  if (!input) return null;\n  \n  // Step 2: Initialize data structures\n  const result = [];\n  \n  // Step 3: Process input\n  for (let item of input) {\n    // Process each item\n  }\n  \n  // Step 4: Return formatted result\n  return result;\n}`
                });
                showNotification('✅ Explanation Ready!', 'success');
            }
        }

        function rateTutorResponse(rating) {
            if (rating === 'helpful') {
                showNotification('Thank you! Your feedback helps improve the AI', 'success');
            } else {
                showNotification('We\'ll improve! Send us feedback in Community', 'info');
            }
            // Update tutor stats
            const problemsSolved = document.getElementById('problemsSolved');
            if (problemsSolved && rating === 'helpful') {
                problemsSolved.textContent = parseInt(problemsSolved.textContent) + 1;
            }
        }

        function clearTutorResponse() {
            document.getElementById('tutorProblem').value = '';
            document.getElementById('tutorResponseBox').style.display = 'none';
            showNotification('✨ Ready for next question', 'info');
        }

        function loadTutorTopic(topic) {
            document.getElementById('tutorProblem').value = `Can you explain ${topic} with examples and code?`;
            askAITutor();
        }

        // Function to show ChatGPT Settings Modal
        function showChatGPTSettings() {
            const currentKey = CHATGPT_CONFIG.apiKey ? CHATGPT_CONFIG.apiKey.substring(0, 10) + '...' : 'Not set';
            const settingsModal = document.createElement('div');
            settingsModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.7);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;
            
            settingsModal.innerHTML = `
                <div class="card" style="width: 90%; max-width: 600px; padding: 30px; position: relative;">
                    <button onclick="this.closest('div[style*=\\'position: fixed\\']').remove()" style="position: absolute; top: 15px; right: 20px; background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--muted);">✕</button>
                    
                    <h2 style="color: var(--primary); font-size: 1.5rem; margin-bottom: 20px;">⚙️ ChatGPT Integration Settings</h2>
                    
                    <div style="background: rgba(14, 165, 164, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--primary);">
                        <p style="color: var(--muted); margin-bottom: 10px;">Current API Key Status:</p>
                        <p style="color: var(--text); font-weight: 600;">${currentKey}</p>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; color: var(--text); margin-bottom: 8px; font-weight: 600;">OpenAI API Key</label>
                        <input type="password" id="chatgptApiKeyInput" placeholder="sk-..." style="width: 100%; padding: 12px; background: rgba(14, 165, 164, 0.1); border: 1px solid rgba(14, 165, 164, 0.3); border-radius: 8px; color: var(--text); font-family: monospace;" value="${CHATGPT_CONFIG.apiKey}">
                    </div>
                    
                    <div style="background: rgba(249, 115, 22, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--warning);">
                        <p style="color: var(--warning); font-weight: 600; margin-bottom: 10px;">How to get your API Key:</p>
                        <ol style="color: var(--muted); font-size: 0.9rem; margin-left: 20px;">
                            <li>Visit <span style="color: var(--primary);">https://platform.openai.com/api-keys</span></li>
                            <li>Sign in with your OpenAI account</li>
                            <li>Click "Create new secret key"</li>
                            <li>Copy and paste it here</li>
                            <li>Your key is stored locally - never shared with anyone</li>
                        </ol>
                    </div>
                    
                    <div style="background: rgba(34, 197, 94, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 3px solid var(--success);">
                        <p style="color: var(--success); font-weight: 600; margin-bottom: 8px;">✅ Benefits of Integration:</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Get accurate, real-time coding solutions</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Personalized explanations for any topic</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Advanced code hints and suggestions</p>
                        <p style="color: var(--muted); font-size: 0.9rem;">• Better problem-solving assistance</p>
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-primary" style="flex: 1; padding: 12px;" onclick="saveChatGPTSettings()">Save API Key</button>
                        <button class="btn-secondary" style="flex: 1; padding: 12px;" onclick="testChatGPTConnection()">Test Connection</button>
                        <button class="btn-secondary" style="flex: 1; padding: 12px;" onclick="this.closest('div[style*=\\'position: fixed\\']').remove()">Close</button>
                    </div>
                </div>
            `;
            document.body.appendChild(settingsModal);
        }

        // Save ChatGPT API Key
        function saveChatGPTSettings() {
            const apiKey = document.getElementById('chatgptApiKeyInput')?.value || '';
            if (setChatGPTKey(apiKey)) {
                showNotification('✅ API Key saved successfully!', 'success');
                updateChatGPTSetupNotice(); // Update the notice visibility
                setTimeout(() => {
                    // Close the modal
                    const modal = document.querySelector('div[style*="position: fixed"]');
                    if (modal) modal.remove();
                }, 500);
            }
        }

        // Test ChatGPT Connection
        async function testChatGPTConnection() {
            if (!CHATGPT_CONFIG.apiKey) {
                showNotification('❌ Please enter an API Key first', 'error');
                return;
            }
            
            showNotification('Testing ChatGPT connection...', 'info');
            const testResponse = await getChatGPTResponse('Say "ChatGPT connection successful" in exactly one sentence.');
            
            if (testResponse) {
                showNotification('✅ ChatGPT connection successful!', 'success');
                showAlert(`Connection Test Result:\n\n✅ API Key is valid\n✅ Connection to OpenAI is working\n✅ ChatGPT is ready to use\n\nResponse: ${testResponse}`);
                updateChatGPTSetupNotice();
            } else {
                showNotification('❌ Connection test failed', 'error');
            }
        }

        // ==================== BLOCKCHAIN FUNCTIONS ====================
        
        async function generateBlockchainAddress() {
            try {
                const userId = currentUser?.id || 'user-' + Date.now();
                const response = await fetch('/api/blockchain/generate-address', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId })
                });
                
                const data = await response.json();
                if (data.status === 'success') {
                    document.getElementById('blockchainAddress').textContent = data.address;
                    showNotification('Blockchain address generated! 🔗', 'success');
                } else {
                    showNotification('Failed to generate address', 'error');
                }
            } catch (err) {
                console.error('Error generating blockchain address:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function loadBlockchainStats() {
            try {
                const response = await fetch('/api/blockchain/stats');
                const data = await response.json();
                
                if (data.status === 'success') {
                    const stats = data.data;
                    document.getElementById('blockchainStats').innerHTML = `
                        <p style="margin-bottom: 8px;">🔐 Transactions: <span style="color: var(--primary); font-weight: 600;">${stats.totalTransactions}</span></p>
                        <p style="margin-bottom: 8px;">✅ Verified Users: <span style="color: var(--primary); font-weight: 600;">${stats.verifiedUsers}</span></p>
                        <p style="margin-bottom: 8px;">🏆 Achievements: <span style="color: var(--primary); font-weight: 600;">${stats.totalAchievements}</span></p>
                        <p style="margin-bottom: 15px;">💎 Total Points Issued: <span style="color: var(--primary); font-weight: 600;">${stats.totalPointsIssued}</span></p>
                    `;
                    showNotification('Blockchain stats loaded! 📊', 'success');
                }
            } catch (err) {
                console.error('Error loading blockchain stats:', err);
                showNotification('Error loading stats', 'error');
            }
        }

        async function issueBlockchainAchievement() {
            try {
                const title = document.getElementById('achievementTitle').value;
                const points = parseInt(document.getElementById('achievementPoints').value);
                const description = document.getElementById('achievementDescription').value;
                
                if (!title || !points || !description) {
                    showNotification('Please fill all fields', 'error');
                    return;
                }

                const response = await fetch('/api/blockchain/issue-achievement', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: currentUser?.id || 'user-' + Date.now(),
                        userName: currentUser?.name || 'Anonymous',
                        achievement: { title, description, points, difficulty: 'Medium' }
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    const cert = data.certificate;
                    const certInfo = `
Certificate Hash: ${cert.certificateHash.substring(0, 16)}...
Blockchain TX: ${cert.blockchainVerification.transactionHash.substring(0, 16)}...
Block Number: ${cert.blockchainVerification.blockNumber}
Verified: ✅ Yes`;
                    alert('🎓 Certificate Issued!\n\n' + certInfo);
                    
                    // Clear form
                    document.getElementById('achievementTitle').value = '';
                    document.getElementById('achievementPoints').value = '';
                    document.getElementById('achievementDescription').value = '';
                    
                    showNotification('Achievement issued on blockchain! 🔗', 'success');
                }
            } catch (err) {
                console.error('Error issuing achievement:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function generateVerifiableCredential() {
            try {
                const response = await fetch('/api/blockchain/verify-credential', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        userId: currentUser?.id || 'user-' + Date.now(),
                        userName: currentUser?.name || 'User',
                        email: currentUser?.email || 'user@example.com',
                        achievements: [
                            { title: 'Python Mastery', points: 500, completedDate: new Date().toISOString() },
                            { title: 'Data Science Pro', points: 750, completedDate: new Date().toISOString() }
                        ]
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    document.getElementById('credentialJSON').textContent = JSON.stringify(data.credential, null, 2);
                    document.getElementById('credentialOutput').style.display = 'block';
                    showNotification('Verifiable credential generated! 📜', 'success');
                }
            } catch (err) {
                console.error('Error generating credential:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function createNFTMetadata() {
            try {
                const blockchainAddress = document.getElementById('blockchainAddress').textContent;
                if (blockchainAddress === 'Loading...' || !blockchainAddress.startsWith('0x')) {
                    showNotification('Please generate blockchain address first', 'error');
                    return;
                }

                const response = await fetch('/api/blockchain/create-nft', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        achievement: { title: 'NFT Badge', description: 'Achievement NFT Badge', points: 100, difficulty: 'Hard' },
                        recipientAddress: blockchainAddress
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    const nft = data.nftMetadata;
                    alert(`🎨 NFT Created!\nName: ${nft.name}\nStandard: ${nft.contract.standard}\nRecipient: ${nft.recipient.substring(0, 10)}...`);
                    showNotification('NFT metadata created! 🖼️', 'success');
                }
            } catch (err) {
                console.error('Error creating NFT:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function createBlockchainTransaction() {
            try {
                const fromAddress = document.getElementById('blockchainAddress').textContent;
                if (fromAddress === 'Loading...' || !fromAddress.startsWith('0x')) {
                    showNotification('Please generate blockchain address first', 'error');
                    return;
                }

                const response = await fetch('/api/blockchain/create-transaction', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        from: fromAddress,
                        to: '0x' + 'a'.repeat(40),
                        data: { type: 'achievement', achievement: 'Test Achievement' }
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    const tx = data.transaction;
                    alert(`🔗 Transaction Created!\nHash: ${tx.hash.substring(0, 16)}...\nGas: ${tx.gasUsed} wei\nStatus: ${tx.status}`);
                    showNotification('Transaction created! 🔗', 'success');
                }
            } catch (err) {
                console.error('Error creating transaction:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function verifyBlockchainTransaction() {
            try {
                const txHash = prompt('Enter transaction hash to verify:');
                if (!txHash) return;

                const response = await fetch(`/api/blockchain/verify-transaction/${txHash}`);
                const data = await response.json();
                
                if (data.verification.verified) {
                    alert(`✅ Transaction Verified!\nStatus: ${data.verification.status}\nConfirmations: ${data.verification.confirmations}`);
                    showNotification('Transaction verified! ✅', 'success');
                } else {
                    showNotification('Transaction not found', 'error');
                }
            } catch (err) {
                console.error('Error verifying transaction:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        async function executeSmartContract() {
            try {
                const func = document.getElementById('contractFunction').value;
                if (!func) {
                    showNotification('Please select a function', 'error');
                    return;
                }

                const response = await fetch('/api/blockchain/contract-interaction', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contractAddress: '0x' + 'b'.repeat(40),
                        functionName: func,
                        parameters: { achievement: 'Test' },
                        caller: document.getElementById('blockchainAddress').textContent,
                        result: { success: true }
                    })
                });

                const data = await response.json();
                if (data.status === 'success') {
                    alert(`⚙️ Smart Contract Executed!\nFunction: ${data.interaction.functionName}\nExecution Time: ${data.interaction.executionTime}ms`);
                    showNotification('Smart contract executed! ⚙️', 'success');
                }
            } catch (err) {
                console.error('Error executing smart contract:', err);
                showNotification('Error: ' + err.message, 'error');
            }
        }

        
    </script>
</body>
</html>
